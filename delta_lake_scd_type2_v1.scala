
// MAGIC dbutils.widgets.text("src_db_name", src_db_name_test, "src_db_name")
// MAGIC dbutils.widgets.text("tgt_db_name", tgt_db_name_test, "tgt_db_name")
// MAGIC dbutils.widgets.text("snapshot_year_month", snapshot_year_month_test, "snapshot_year_month")
// MAGIC dbutils.widgets.text("snapshot_day", snapshot_day_test, "snapshot_day")
// MAGIC dbutils.widgets.text("adls_curtn_basepath", adls_curtn_basepath_test, "adls_curtn_basepath")
// MAGIC dbutils.widgets.text("process_date", process_date_test, "process_date")
// MAGIC dbutils.widgets.text("tgt_table_name", tgt_table_name_test, "tgt_table_name")
// MAGIC dbutils.widgets.text("stg_db_name", stg_db_name_test, "stg_db_name")*/

// COMMAND ----------

// MAGIC %scala
// MAGIC 
// MAGIC val src_db_name = dbutils.widgets.get("src_db_name")
// MAGIC val tgt_db_name = dbutils.widgets.get("tgt_db_name")
// MAGIC val tgt_table_name = dbutils.widgets.get("tgt_table_name")
// MAGIC val snapshot_year_month = dbutils.widgets.get("snapshot_year_month")
// MAGIC val snapshot_day = dbutils.widgets.get("snapshot_day")
// MAGIC val adls_curtn_basepath = dbutils.widgets.get("adls_curtn_basepath")
// MAGIC val process_date = dbutils.widgets.get("process_date")
// MAGIC val stg_db_name = dbutils.widgets.get("stg_db_name") 
// MAGIC 
// MAGIC sqlContext.sql("set spark.sql.shuffle.partitions=5000"); 

// COMMAND ----------

// MAGIC %sql
// MAGIC CREATE DATABASE IF NOT EXISTS $stg_db_name; 
// MAGIC CREATE TABLE IF NOT EXISTS $stg_db_name.mm_delta (
// MAGIC `tuns_pk` BIGINT COMMENT 'Any value without business meaning that uniquely distinguishes each occurrence of the entity.',
// MAGIC `tuns_alt_busn_key` BIGINT COMMENT 'Any value without business meaning that uniquely distinguishes occurrences of the entity independently of its history.',
// MAGIC `tuns_nbr` STRING COMMENT 'DUNS Number: The 9-digit Data Universal numbering System (DUNS) numeric serial number for a company. No two establishments have the same D&B DUNS Number. DUNS numbers are not recycled and stay with a business throughout its life. For example, if a business ceases operations, or goes bankrupt, that entity still keeps the same DUNS. If a company merges, or is acquired by another company, it will report up through the other company\'s family tree with the same DUNS number, or all their assets will fall under the new company and their DUNS number will no longer be used.',
// MAGIC `late_actv_rec_ind` STRING COMMENT 'Indicates whether this is the most current record for the particular alternate business key. NOTE: There must be one and only one row that is indicated as the "latest active" (with a \'Y\' (Yes) value).',
// MAGIC `busn_actv_rec_ind` STRING COMMENT '',
// MAGIC `act_firm_nm` STRING COMMENT 'Accounting Firm Name: The name of the accounting firm that this business uses for accounting purposes.',
// MAGIC `appd_fil_1_txt` STRING COMMENT 'Append filler 1 text',
// MAGIC `appd_fil_2_txt` STRING COMMENT 'Append filler 2 text',
// MAGIC `appd_empe_here_cnt` STRING COMMENT 'Value from the Append D&B file.',
// MAGIC `appd_extrc_load_and_trfm_bat_id` STRING COMMENT 'Value from the Append D&B file.',
// MAGIC `appd_extrc_load_and_trfm_run_dt` STRING COMMENT 'Employees - Location (Here): Employees are generally defined as the total number of people who contribute to the sales and operations of a business, including principals and full or part time employees. Employees Here is defined as the number of employees at a given physical site of the business. Site employees is only the employees at that location. Total employees works the same way as Sales does. Total Employees reflects the employees at that site and all sites under it, regardless of whether or not they are in the same country. The Global Ultimate Total Employees reflects all the employees in the organization. Value from the Append D&B file.',
// MAGIC `appd_hdqt_tuns_nbr` STRING COMMENT 'Headquarters DUNS Number: The DUNS number of HQ location if the listing is a branch. For HQ records the same DUNS number may appear in this field. This allows the computer to tie branch locations to their appropriate HQ record.',
// MAGIC `appd_import_eprt_cd` STRING COMMENT 'Value from the Append D&B file.',
// MAGIC `appd_minr_ownd_ind` STRING COMMENT 'Value from the Append D&B file.',
// MAGIC `appd_rec_del_ind` STRING COMMENT 'Y If Deleted At Source Otherwise Blank Value from the Append D&B file.',
// MAGIC `appd_subsdy_ind` STRING COMMENT 'Family Tree - Subsidiary Indicator: CSAD Data. Subsidiary Indicator If Parent DUNS 0. Indicates that a corporation that is more than 50% owned by another company. 0 = NO. 3 = YES.Value from the Append D&B file. ',
// MAGIC `base_catg_ind` STRING COMMENT 'Base Record Type Indicator: CSAD Data. Base Category Indicator RECORD TYPE. A = ANALYTICAL. B = BRANCH. R = FULL. S = DUNS SUPPORT. X = DUNS SUPPORT XREF. Not available for non-US entities.',
// MAGIC `base_rpt_dt` STRING COMMENT 'Base Report Date: CSAD Data. Date of Base Report YYMMDD.',
// MAGIC `base_sls_yy_amt` DECIMAL(38,16) COMMENT 'Sales - Base Year: The sales volume in the first year of a three year trend period. For 2013 this would be sales for 2010. Trending numbers are usually pulled in June or July. Includes the sales for this DUNS and any DUNS that report directly to it. Parent DUNS will also include the sales of any subsidiaries.',
// MAGIC `base_yy_empe_cnt` STRING COMMENT 'Employees - Base Year : The employee count in the first year of a three year trend period.',
// MAGIC `bkrp_dt` STRING COMMENT 'Bankruptcy Date: CSAD Data. Bankruptcy Date YYYYMMDD.',
// MAGIC `bnk_tuns_nbr` STRING COMMENT '',
// MAGIC `burg_ind` STRING COMMENT 'Burglary Flag: CSAD Data. Burglary Occurred. 0 = NO. 1 = YES.',
// MAGIC `busn_nm` STRING COMMENT 'Business Name: The offical registered or legal name of the business. For U.S. records the Business Name does not represent tradestyle names, nor may it reflect the exact official registered business name. For non-U.S. records, the Business Name is generally the registered name.',
// MAGIC `carr_rout_cd` STRING COMMENT 'Carrier Route Code: Identifies the individual mail carrier assigned to the postal route post office box or highway contract route. Sorting by carrier enables the sender to take advantage of postal discounts.',
// MAGIC `cbl_telex_nbr` STRING COMMENT 'Cable_Telex Number: The cable or telex number of the business.',
// MAGIC `ccs_cd` STRING COMMENT 'Commercial Credit Score US (v7): Commercial Credit Score version 7. This is a segmentation of the scoreable universe into distinct risk groups where a 1 represents businesses that have the lowest probability of severe delinquency and a 5 represents businesses with the highest probability of severe delinquency. A score of 0 could denote a confirmed High Risk or Bankrupt, but may have other meanings as well. A blank generally means that scoring is not available in that particular industry, but could also have other meanings. This data does not use the Transunion scores and therefore is not affected by the contract ending between Transunion and D&B. This score will remain an actively updated score after v8 is dropped.',
// MAGIC `ccs_vers_8_cd` STRING COMMENT 'Commercial Credit Score US v8: Discontinued as of May 2015',
// MAGIC `ccs_vers_8_pct_nbr` STRING COMMENT 'Commercial Credit Percentile US v8: Discontinued as of May 2015',
// MAGIC `ccs_vers_9_pct_nbr` STRING COMMENT 'CCS_V9_Percentile: Part of D&B US Delinquency Predictor. Predicts the likelihood that a company will pay in a severely delinquent manner over the next 12 months, seek legal relief from creditors, or cease operations without paying all creditors in full over the next 12 months based on the information in D&B\'s database. A severely delinquent firm is defined as a business with at least 10% of its dollars 91+ days slow. Dollars are weighted based on total balance of 91+ accounts compared to total balance owed.',
// MAGIC `ccs_vers_9_pnt_cd` STRING COMMENT 'CCS_V9_Points: Part of D&B US Delinquency Predictor. Predicts the likelihood that a company will pay in a severely delinquent manner (91+ days past term) over the next 12 months, seek legal relief from creditors, or cease operations without paying all creditors in full over the next 12 months based on the information in D&B\'s database. A severely delinquent firm is defined as a business with at least 10% of its dollars 91+ days slow. Dollars are weighted based on total balance of 91+ accounts compared to total balance owed.',
// MAGIC `ccs_vers_9_scor_cd` STRING COMMENT 'CCS_V9_Score: Part of D&B US Delinquency Predictor. Predicts the likelihood that a company will pay in a severely delinquent manner over the next 12 months, seek legal relief from creditors, or cease operations without paying all creditors in full over the next 12 months based on the information in D&Bs database. A severely delinquent firm is defined as a business with at least 10% of its dollars 91+ days slow. Dollars are weighted based on total balance of 91+ accounts compared to total balance owed. One of the three measurement of risk this is a class score of 1 - 5, which segments the scoreable universe into five distinct risk groups.',
// MAGIC `chief_exec_ofcr_fst_nm` STRING COMMENT 'CEO First Name: The first name in a fixed field of the individual identified as having the chief executive function at the business.',
// MAGIC `chief_exec_ofcr_full_nm` STRING COMMENT 'CEO Full Name: The full name in a fixed field of the individual identified as having the chief executive function at the business.',
// MAGIC `chief_exec_ofcr_gndr_cd` STRING COMMENT 'CEO Gender Code: The gender code of the indivudual at the site with Chief Executive Responsibility.',
// MAGIC `chief_exec_ofcr_lst_nm` STRING COMMENT 'CEO Last Name: The last name in a fixed field of the individual identified as having the chief exective function at the business.',
// MAGIC `chief_exec_ofcr_mgmt_resp_cd` STRING COMMENT 'CEO MRC Code: Management Responsibility Order MRC identifies the title of the individual identified as having the Chief Executive Function at the business from the DUNS Decision Maker File.',
// MAGIC `chief_exec_ofcr_mid_init_abbr` STRING COMMENT 'CEO Middle Initial: The middle initial in a fixed field of the individual identified as having the chief executive function at the business.',
// MAGIC `chief_exec_ofcr_prfx_ttl_nm` STRING COMMENT 'CEO Prefix: A qualifer that precedes an individual\'s first name such as Mr., Mrs., Dr., etc.',
// MAGIC `chief_exec_ofcr_suff_ttl_nm` STRING COMMENT 'CEO Suffix: A qualifier that follows an individuals full name - examples are Jr., Sr., MD., etc.',
// MAGIC `chief_exec_ofcr_ttl_abbr` STRING COMMENT 'CEO Title: The abbreviated title of the individual at the site with the chief executive responsibility.',
// MAGIC `cml_cr_pct_nbr` STRING COMMENT 'Commercial Credit Percentile US (v7): CSAD Data. 1 to 100 (High to Low Risk). 0 = Out of business, debtor in possession, confirmed higher risk; Blank = not available. This data does not use the Transunion scores and therefore is not affected by the contract ending between Transunion and D&B. This score will remain an actively updated score after v8 is dropped.',
// MAGIC `cmnl_prcd_ind` STRING COMMENT 'Criminal Proceedings Indicator: CSAD Data. Criminal proceedings.',
// MAGIC `cnda_ccs_pct_cd` STRING COMMENT 'CREDIT SCORE PERCENTLE  1 TO 100 (HIGH RISK TO LOW RISK) SCALE (0 = OUT OF BUSINESS, DEBTOR IN POSSESSION, CONFIRMED HIGHER RISK; BLANK = NOT AVAIL.)',
// MAGIC `cnda_ccs_raw_scor_cd` STRING COMMENT 'CREDIT SCORE POINTS 101 TO 660 (HIGH RISK TO LOW RISK) SCALE (0 = OUT OF BUSINESS, DEBTOR IN POSSESSION,CONFIRMED HIGHER RISK; BLANK = NOT AVAIL.)',
// MAGIC `cnda_ccs_rsk_cls_cd` STRING COMMENT 'COMMERCIAL CREDIT SCORE CLASS 1 TO 5 (LOW RISK TO HIGH RISK) SCALE(0 = OUT OF BUSINESS, DEBTOR IN POSSESSION,CONFIRMED HIGHER RISK; BLANK = NOT AVAIL.)',
// MAGIC `cnda_finc_stmt_summ_pct_cd` STRING COMMENT 'FINANCIAL STRESS PERCENTILE  1 TO 100 (HIGH RISK TO LOW RISK) SCALE(0 = OUT OF BUSINESS, DEBTOR IN POSSESSION,CONFIRMED HIGHER RISK; BLANK = NOT AVAIL.)',
// MAGIC `cnda_finc_stmt_summ_rsk_cls_cd` STRING COMMENT 'FINANCIAL STRESS SCORE 1 TO 5 (LOW RISK TO HIGH RISK) SCALE WHICH ASSESES THE LIKELIHOOD THAT A BUSINESS WILL EXPERIENCE FINANCIAL DISTRESS WITHIN THE NEXT 18 MONTHS(0 = OUT OF BUSINESS, DEBTOR IN POSSESSION,CONFIRMED HIGHER RISK; BLANK = NOT AVAIL.)',
// MAGIC `cnty_cd` STRING COMMENT 'Physical Address County Code: Each county within a state is defined with a unique county number. This code reflects the county number within this particular state.',
// MAGIC `co_ctry_nm` STRING COMMENT 'Physical Address Country Name: The country within which a particular business site is located.',
// MAGIC `co_nm` STRING COMMENT 'Company Name: The business name used by this business site.',
// MAGIC `co_str_yy` STRING COMMENT 'Year Business Started: CSAD Data. This is the year the company actually started business.',
// MAGIC `co_typ_cd` STRING COMMENT 'Company Legal Structure: CSAD Data. Legal structure or company type: G = Proprietership, H = Partnership, I = Corporation, J = Non-Profit, space OR O = not available or not applicable.',
// MAGIC `cond_ratg_cd` STRING COMMENT 'Condition Indicator: CSAD Data. Condition Indicator describes the condition of the company. It includes items like financial condition, physical condition, and circumstances (did the company just have a fire for example). T = STRONG, U = GOOD, V = FAIR, W = UNBALANCED, BLANK = NOT AVAILABLE. D&B (Bob McLaughlin) cannot validate that this data element is still being updated with the same efforts it once was.',
// MAGIC `cr_pnt_cd` STRING COMMENT 'Commercial Credit Points US (v7): CSAD Data. Points contains the raw score. Points are then used to create the commercial credit score. Valid values are: 101-670 (High Risk to Low Risk); 000 (OB Debtor in Possession and others); blank (none assigned not available confirmed Higher Risk Business Deterioration). This data does not use the Transunion scores and therefore is not affected by the contract ending between Transunion and D&B. This score will remain an actively updated score after v8 is dropped.',
// MAGIC `cr_ratg_cd` STRING COMMENT 'Credit Rating D&B: CSAD Data. Current D&B Credit Rating. Measures credit worthiness.',
// MAGIC `cr_scor_cd` STRING COMMENT 'Commercial Credit Score US v7: CSAD Data. Duplicate of Custom File.Commercial Credit Score V7',
// MAGIC `cr_scor_vers_7_pct` STRING COMMENT 'Commercial Credit Percentile Version7',
// MAGIC `crcy_cd` STRING COMMENT 'Currency Code: Code indicating in which currency the annual sales volume networth and profit-loss are expressed.',
// MAGIC `csad_bkrp_ind` STRING COMMENT 'Bankruptcy Indicator: CSAD Data. Indicated presence of an open or closed bankruptcy. Branches carry the value of their HQ location.',
// MAGIC `csad_data_hist_cd` STRING COMMENT 'History: CSAD Data. History Indicator of prior bankruptcy or criminal activity. P = history of prior bankruptcy or criminal activity based on the DUNS number, O = incomplete - used when one or more of the following exist: (A) one or more of the requirements for a CLEAR history caption are not obtained; (B) BUSINESS or MANAGEMENT history caption does not apply; (C) the information consultant has reviewed the information in the report and in his or her judgment the assignment should be Incomplete, N = Clear - Assigned in the caption when all of the following critical pieces of information are present: (a) First name last name and title (e.g. Owner Partner President etc) of the Chief Executive of the business; (B) Legal Structure; (C) Ownership of the business has been identified (for Private Corporations at least 51% of the capital stock is accounted for); (D) Business Start Date or Present Control Date; (e) Business Address; (F) Business Phone Number; (g) No information which would cause the assignment of a BUSINESS or MANAGEMENT history caption or the designation as a potential Higher Risk case., Q = the owner of the company had a prior bankruptcy or criminal activity, BLANK = not available. This value will be available only if the value of BASECAT is not blank.',
// MAGIC `csad_lien_cnt` STRING COMMENT 'Liens - Number of: CSAD Data. Total number of liens with the following caveats: If this is a branch location, this is the total number of liens for the headquarters location, not the branch. In the case of a Headquarters location, all liens at the branch level will roll up to the respective HQ DUNS. There is no roll-up from Subsidiary to Parent, as these are their own legal entity. Not available for non-US entities. All liens are removed frm the count, once the obligation is fulfilled, or a period of 10 years has passed.',
// MAGIC `csad_suit_cnt` STRING COMMENT 'Suits - Number of: CSAD Data. Total Number of Suits. If this is a branch location this record carries the value for the headquarters. In the case of a Headquarters location all suits at the branch level will roll up to the respective HQ DUNS. There is no roll-up from Subsidiary to Parent as these are their own legal entity. All suits are removed after a period of 10 years has passed.',
// MAGIC `ctry_tel_acss_cd` STRING COMMENT 'Telephone Country Access Code: The code nesseccary to dial prior to the telephone number to connect to the specific country.',
// MAGIC `cty_map_cd` STRING COMMENT 'City Map Code: Each city within a state is defined with a unique city number. This code reflects the city number within this particular state. This code can be used to sort cities within a state into alphabetical order.',
// MAGIC `cur_mgmt_str_yy` STRING COMMENT 'Year Current Management Started: CSAD Data. The year when current ownership or management assumed control of the business, or the year established, if no control change has taken place. This is not provided for branch records. Sourced from CSAD; therefore if this is a branch, this record carries the value of the headquarters. Start Year and Control Year are typically from a trusted source like Business Registry, UCC filings, business licenses, tax certficates, professional licensing agency, etc. This information may be obtained from from the business principal, but must be accompanied with independent or third party verification. This is a duplicate of Custom File.YearPresentControl.',
// MAGIC `custm_bkrp_ind` STRING COMMENT 'Bankruptcy Indicator: Code indicating that according to D&Bs file the business is operating under bankruptcy proceedings. This indicator remains until the business either emerges from the proceedings or ceases operations. N = No. Y = Yes. From the Custom file',
// MAGIC `custm_empe_here_cnt` STRING COMMENT 'Employees - At this Location: CSAD Data. Number of Employees Reported at Location. From the Custom file',
// MAGIC `custm_extrc_load_and_trfm_bat_id` STRING COMMENT 'From the Custom file',
// MAGIC `custm_extrc_load_and_trfm_run_dt` STRING COMMENT 'From the Custom file',
// MAGIC `custm_fil_1_txt` STRING COMMENT 'Append filler 1 text',
// MAGIC `custm_hdqt_tuns_nbr` STRING COMMENT 'Headquarters DUNS Number: CSAD Data - Headquarters DUNS Number. Custom File.HQ_DUNS is a duplicate of Append File.DATA-APP-HQ-DUNS-NBR',
// MAGIC `custm_import_eprt_cd` STRING COMMENT 'From the Custom file',
// MAGIC `custm_minr_ownd_ind` STRING COMMENT 'Minority Owned Indicator: Code indicating if a minority owns the majority of the establishment. This information is collected via Public Record filings with the SBA and the Dept. of Commerce, 3rd Party Sources, and internal D&B investigations. Y = Minority Owned, N = Not Minority Owned. Not available for non-US entities.From the Custom file',
// MAGIC `custm_otf_busn_ind` STRING COMMENT 'Out of Business Indicator: CSAD Data. Out of Business Indicator. Custom File. OB_IND is a duplicate of Reference File. REF-OUT-BUS-FLAG except for the formatting. From the Custom file',
// MAGIC `custm_rec_del_ind` STRING COMMENT 'Y If Deleted At Source Otherwise Blank From the Custom file',
// MAGIC `custm_subsdy_ind` STRING COMMENT 'Family Tree - Subsidiary Indicator: Duplicate of Append File.DATA-APP-SUBSIDIARY-IND. From the Custom file',
// MAGIC `custm_tel_nbr` STRING COMMENT 'Telephone Number: CSAD Data. The telephone number associated with this site with the exception of branched which carry the phone number of the headquarters location.',
// MAGIC `custm_tixie_ind` STRING COMMENT 'Tixie Flag: CSAD Data. Tixies are business records that contain a telephone number identified as no longer in service or does not reach the business listed on the report. Tixie records are included in the WorldBase Active universe but excluded from the WorldBase Marketable universe. For branches the tixie indicator represents the tixie status at the headquarters level. From the Custom file',
// MAGIC `data_appd_cnti_cd` STRING COMMENT 'Continent Code: This field identifies the continent of the record. The values are:1 = Africa, 2 = Asia Pacific, 3 = Europe, 4 = Middle East, 5 = Latin America, 6 = North America Source Data Append File',
// MAGIC `data_appd_st_nm` STRING COMMENT 'The name of the state. Source data append file',
// MAGIC `data_appd_tel_nbr` STRING COMMENT 'Primary Phone Number at the business locationSource Data Append file',
// MAGIC `data_appd_updt_dt` STRING COMMENT 'Date record was last updated. yyyymmdd, e.g., 20021126. Source Data Append file',
// MAGIC `data_rep_dt` STRING COMMENT 'Date Data Represented: CSAD Data. This is the date of this data MMMYY. Not available for non-US entities.',
// MAGIC `data_updt_usr_id` STRING COMMENT 'In Date Indicator: CSAD Data. Measures the age of the data D&B uses to drive credit data elements. A record that is In Date for example means D&B has enough credit data of the proper age to drive our credit indicators. I = in date, T = too old, D = DUNS support, P = promised later.',
// MAGIC `debt_ind` STRING COMMENT 'Debtor in Possession Indicator: CSAD Data. Debtor in Possession Indicator 0 = NO, 1 = YES.',
// MAGIC `dias_cd` STRING COMMENT 'Dias Code: This code sequences a family tree group from the ultimate to the lowest business in the group. This code has no intrinsic value and can change from month to month. If this business is not part of a corporate family this field will be blank.',
// MAGIC `div_ind` STRING COMMENT 'Division Indicator: Designates A Separate Profit Center As Reported By The Principals At The Time Of The D&B Interview.',
// MAGIC `dlist_ind` STRING COMMENT 'Delist Flag: Subject Requested not to be included in mailingtelemarketing list products. N- Everything OK, Y - AS indicated. Note: Multiple rows may exist for a single DUNS on this table.',
// MAGIC `dom_ult_busn_nm` STRING COMMENT 'This is the Domestic Ultimate Business Name.',
// MAGIC `dom_ult_ctry_cd` STRING COMMENT 'Domestic Ultimate Country Code: The country of the topmost firm of a domestic family tree group of companies.',
// MAGIC `dom_ult_tuns_nbr` STRING COMMENT 'Domestic Ultimate DUNS Number: DUNS Number for the domestic ultimate which is the highest family member in the same country as this business entity as you walk up this branch of the tree. A case may be its own domestic ultimate.',
// MAGIC `dom_ult_fips_ctry_cd` STRING COMMENT 'Domestic Ultimate FIPS Country Code: Code for the country where the domestic ultimate is located. Blank if not linked.',
// MAGIC `dom_ult_st_abbr` STRING COMMENT 'Domestic Ultimate State Abbreviation: Abbreviated name of the state or province in which the domestic ultimate is located. Blank if not linked.',
// MAGIC `dt_ind` STRING COMMENT 'In Date Indicator: CSAD Data. Measures the age of the data D&B uses to drive credit data elements. A record that is In Date for example means D&B has enough credit data of the proper age to drive our credit indicators. I = in date, T = too old, D = DUNS support, P = promised later.',
// MAGIC `due_thrty_dd_amt` STRING COMMENT 'Amount Owed - 30 Days: CSAD Data. Amount Owed for 30 Days.',
// MAGIC `tuns_cr_ratg_cd` STRING COMMENT 'Credit Rating D&B - Previous: CSAD Data. Previous D&B Rating.',
// MAGIC `dup_cur_mgmt_str_yy` STRING COMMENT 'Year Current Management Started: CSAD Data. The year when current ownership or management assumed control of the business, or the year established, if no control change has taken place. This is not provided for branch records. Sourced from CSAD; therefore if this is a branch this record carries the value of the headquarters. Start Year and Control Year are typically from a trusted source like Business Registry, UCC filings, business licenses, tax certficates, professional licensing agency, etc. This information may be obtained from from the business principal, but must be accompanied with independent or third party verification. This is a duplicate of Custom File.YearPresentControl.',
// MAGIC `dup_jdgt_cnt` STRING COMMENT 'Judgements - Number of: See DI__CUSTOM_APPEND.JUDMNTS.',
// MAGIC `econ_area_of_inflnc_cd` STRING COMMENT 'Economic Area of Influence Code: A code denoting an area of economic influence as designated by the bureau of economic analysis.',
// MAGIC `empe_here_cd` STRING COMMENT 'Employees - Location (Here) Reliability Code: Employee figures can be represented as actual (collected figure), estimated (collected approximation figure), or modeled (derived). U.S. and global marketing products have slight differences in reliability codes. Reliability Code Values - US: Blank = Not applicable, 0 = Actual value, 1 = Low end of Range (The employee number D&B obtained came to D&B as a range. For example if D&B identifies that a company has 10-15 employees, we will use the value of 10 and flag that as the low end of the range of supplied data), 2 = Unknown or Modeled. Reliability Code Values - Global: Blank = Not applicable, 0 = Actual Value, 1 = Low end of Range (ex: 10-15 employees), 2 = Estimated, 3 = Modeled.',
// MAGIC `empe_tot_cd` STRING COMMENT 'Employees Total - Reliability Code: Employee figures can be represented as actual (collected figure), estimated (collected approximation figure), or modeled (derived). U.S. and global marketing products have slight differences in reliability codes. Reliability Code Values - US: Blank = Not applicable, 0 = Actual value, 1 = Low end of Range (The employee number D&B obtained came to D&B as a range. For example, if D&B identifies that a company has 10-15 employees, we will use the value of 10 and flag that as the low end of the range of supplied data.), 2 = Unknown or Modeled, Reliability Code Values - Global: Blank = Not applicable, 0 = Actual Value, 1 = Low end of Range (ex: 10-15 employees), 2 = Estimated (or unavailable when employee figure is zero), 3 = Modeled',
// MAGIC `empe_tot_cnt` STRING COMMENT 'Employees Total: Employees are generally defined as the total number of people who contribute to the sales and operations of a business, including principals and full or part time employees. Employees Total is defined as the total number of people employed by all branches and subsidiaries of a business. Site employees is only the employees at that location. Total employees works the same way as Sales does. Total Employees reflects the employees at that site and all sites under it, regardless of whether or not they are in the same country. The Global Ultimate Total Employees reflects all the employees in the organization.',
// MAGIC `empe_trnd_3_yy_cnt` STRING COMMENT 'Employees - 3 Year Trend: The employee count in the last year of a three year period.',
// MAGIC `empe_trnd_5_yy_cnt` STRING COMMENT 'Employees - 5 Year Trend: The employee count in the last year of a five year period.',
// MAGIC `equiv_annl_annty_stmt_dt` STRING COMMENT 'EAA Statement Date: CSAD Data. The date of the EAA statement YYYYMMDD.',
// MAGIC `equiv_annl_annty_typ_cd` STRING COMMENT 'EAA Statement Type: CSAD Data. EAA Statement Type: A = fiscal, B = interim, E = pro forma, H = signed estimate, I = insigned estimate, C = consolidated, D = individual, J = restated, X = minimal interim, Y = minimal fiscal, O = no start.',
// MAGIC `fax_nbr` STRING COMMENT 'FAX number: The fax number of the business. Provided as entered in the local database. No edits are performed.',
// MAGIC `fein` STRING COMMENT 'Federal Employee Identification Number',
// MAGIC `ffth_trd_styl_nm` STRING COMMENT 'Trade Style #5: The tradestyle name is otherwise known as the doing business as name, and in many cases, it is the storefront name (ex. ABC Inc is the business name and they do business as - Bob\'s Bar and Grill.) We capture up to 5 names that the business is doing business as, in addition to the business name for most local and global products. For U.S. records, the Tradestyle Name is the doing business as name, as well as the common view name, which is the standardized view of the many variations of a franchise name. Example: McDonald\'s Store 185 is the business name and the common view name would be McDonald\'s. The common view name will only be found in the first tradestyle name field.',
// MAGIC `fil_10_txt` STRING COMMENT 'Filler10',
// MAGIC `fil_11_txt` STRING COMMENT 'Filler11',
// MAGIC `fil_12_txt` STRING COMMENT 'Filler12',
// MAGIC `fil_13_txt` STRING COMMENT 'Filler13',
// MAGIC `fil_14_txt` STRING COMMENT 'Filler14',
// MAGIC `fil_15_txt` STRING COMMENT 'Filler15',
// MAGIC `fil_16_txt` STRING COMMENT 'Filler16',
// MAGIC `fil_17_txt` STRING COMMENT 'Filler17',
// MAGIC `fil_2_txt` STRING COMMENT 'Filler: Was previously Unsecured Loan. This data is no longer provided by D&B. Is this also displayed in  Custom Report',
// MAGIC `fil_4_txt` STRING COMMENT 'Filler: Was previously Bank Name. DI__CUSTOM_APPEND.Filler4 is no longer being fed by D&B but is used to populate the  Lookup and  Custom Report.',
// MAGIC `fil_5_txt` STRING COMMENT 'Filler: Was previously Bank Address. DI__CUSTOM_APPEND.Filler5 is no longer being fed by D&B but is used to populate the  Lookup and  Custom Report.',
// MAGIC `fil_6_txt` STRING COMMENT 'Filler: Was previously Bank City. DI__CUSTOM_APPEND.Filler6 is no longer being fed by D&B but is used to populate the  Lookup and  Custom Report.',
// MAGIC `fil_7_txt` STRING COMMENT 'Filler: Was previously Bank State. DI__CUSTOM_APPEND.Filler7 is no longer being fed by D&B but is used to populate the  Lookup and  Custom Report.',
// MAGIC `fil_8_txt` STRING COMMENT 'Filler: CSAD Data. Was previously Bank Zip. DI__CUSTOM_APPEND.Filler8 is no longer being fed by D&B but is used to populate the  Lookup and  Custom Report BankZipCode	STRINGBankZipCode.',	
// MAGIC `fil_9_txt` STRING COMMENT 'Filler9',
// MAGIC `finc_cd` STRING COMMENT 'Type of Financing Flag: CSAD Data. Financing Indicator. R = SECURED, S = UNSECURED, SPACE OR O = NA.',
// MAGIC `finc_strs_pct_nbr` STRING COMMENT 'Financial Stress Percentile US (v7): 1 to 100 (High to Low Risk), 0 = Out of business debtor in possession confirmed higher risk, Blank = not available. Version 7 Duplicated with Custom File.FPCT V7 due to previous shared deliverable between Farmers and  for mapping purposes. Same data resides in both fields. Not available for non-US entities.',
// MAGIC `finc_strs_pnt_cd` STRING COMMENT 'Financial Stress Score Points: CSAD Data - FINANCIAL STRESS SCORE POINTS. Not available for non-US entities.',
// MAGIC `finc_strs_scor_cd` STRING COMMENT 'Financial Stress Score US (v7.1): Financial Stress Score (V7+J249). Scale which assesses the likelihood that a business will experience financial distress within the next 18 months. 1 to 5 (Low to High Risk). (0 = Out of business debtor in possession confirmed higher risk; Blank = not available). Not available for non-US entities.',
// MAGIC `finc_strs_scor_vers_7_1_cd` STRING,		
// MAGIC `finc_strs_scor_vers_7_1_pct_nbr` STRING COMMENT 'Financial Stress Percentile US (v7.1): This is the percentile class in which the organization falls when assessed the likelihood of the business experiencing financial distress within the next 18 months. A score of 100 indicates it is a low percentage that this company will go out of business. Financial Stress Percentile (V7.1). 1 to 100 (High to Low Risk). 0 = Out of business debtor in possession confirmed higher risk; Blank = not available. Version 7.1. Not available for non-US entities.',
// MAGIC `finc_strs_scor_vers_7_cd` STRING COMMENT 'Financial Stress Score US (v7): CSAD Data. Scale which assesses the likelihood that a business will experience financial distress within the next 18 months. 1 to 5 (Low to High Risk). (0 = Out of business debtor in possession confirmed higher risk; Blank = not available).',
// MAGIC `finc_strs_vers_7_pct_nbr` STRING COMMENT 'Financial Stress Percentile Version 7',
// MAGIC `fips_cnty_cd` STRING COMMENT 'Federal information processing standard county code',
// MAGIC `fips_ctry_cd` STRING COMMENT 'FIPS Country Code: Federal Information Processing Standard FIPS country code is a code assigned by the Federal Government to aid statistical analysis and electronic data processing.',
// MAGIC `fips_metro_stat_area_cd` STRING COMMENT 'FIPS MSA Code: Federal Information Processing Standard FIPS Metropolitan Statistical Area MSA. An MSA consists of a central city or urbanized area of at least 50000 surrounding counties or counties commuting to the central area.',
// MAGIC `fips_sdiv_1_cd` STRING COMMENT 'FIPS Subdivision 1 Code: Federal Information Processing Standard FIPS subdivision state code.',
// MAGIC `fips_sdiv_2_cd` STRING COMMENT 'FIPS Subdivision 2 Code: Federal Information Processing Standard FIPS subdivision county code.',
// MAGIC `fir_occr_ind` STRING COMMENT 'Fire Occurred Flag: CSAD Data. Fire Occurred. 0 = NO, 1 = YES.',
// MAGIC `five_yy_empe_grw_pct` STRING COMMENT 'Employee - 5 Year Growth Percentage Concatenated: Provides information on the total percent growth or decline in the number of employees over a five year period. Includes + or - sign.',
// MAGIC `five_yy_sls_grw_pct` STRING COMMENT 'Sales - Percentage Growth 5 yr Concatenated: Provides information on the total percent growth or decline in sales volume over a five year period. Includes + or - sign.',
// MAGIC `frgn_fam_mbr_ind` STRING COMMENT 'A code indicating if there are family tree members outside of the United States. Values: \'Y\' = Foreign Family Members, \'N\' = No Foreign Family Members',
// MAGIC `fst_exec_fst_nm` STRING COMMENT 'First Executive First Name: The first name in a fixed field of the individual identified in the DUNS decision maker file.',
// MAGIC `fst_exec_full_nm` STRING COMMENT 'First Executive Full Name: The First, Second & Third executive names are from D&B and appended as part of the standard IM process. This means the CEO is pulled as the top contact and then the three additional executive names are populated from our DDM (exec names) file, but there is no selection logic between the two that states if the 1st exec = CEO then don\'t use it; therefore in some cases the CEO and one of the executive names could be the same.',
// MAGIC `fst_exec_gndr_cd` STRING COMMENT 'First Executive Gender Code: The gender code of the individual identified as the first executive of the business',
// MAGIC `fst_exec_lst_nm` STRING COMMENT 'First Executive Last name: The last name in a fixed field of the individual identified in the DUNS decision maker file.',
// MAGIC `fst_exec_mgmt_resp_cd` STRING COMMENT 'First Executive MRC: Management Responsibility Code MRC identifies the first executives title andor area of responsibility from the DUNS decision maker file.',
// MAGIC `fst_exec_mid_init_abbr` STRING COMMENT 'First Executive Middle Initial: The middle initial in a fixed field of the individual identified in the DUNS decision maker file.',
// MAGIC `fst_exec_prfx_nm` STRING COMMENT 'First Executive Prefix: A qualifier that precedes an individuals first name - examples are Mr., Mrs., Dr., etc.',
// MAGIC `fst_exec_suff_nm` STRING COMMENT 'First Executive Suffix: A qualifier that follows an individuals full name - examples are Jr., Sr., MD., etc.',
// MAGIC `fst_exec_ttl_nm` STRING COMMENT 'First Executive Titile: The abbreviated title of the indivudual at the site identified in the DUNS decision maker file.',
// MAGIC `fth_trd_styl_nm` STRING COMMENT 'Trade Style #4: The tradestyle name is otherwise known as the doing business as name, and in many cases, it is the storefront name (ex. ABC Inc is the business name and they do business as - Bob\'s Bar and Grill.) We capture up to 5 names that the business is doing business as, in addition to the business name for most local and global products. For U.S. records, the Tradestyle Name is the doing business as name, as well as the common view name, which is the standardized view of the many variations of a franchise name. Example: McDonald\'s Store 185 is the business name and the common view name would be McDonald\'s. The common view name will only be found in the first tradestyle name field.',
// MAGIC `geo_lttd_lngd_accu_ind` STRING COMMENT 'Geo Info - Lat / Long Accuracy Flag: Latitude and longitude coordinates are based on the record address utilizing a map interpolation procedure. Each record is run through multiple geocode processes to insure the latest geocode coordinates. D&B incorporates multiple street databases including the number one street file database (NAVTEQ) into a multi-layered geocode system with increased coordinate accuracy displayed to 6 places beyond the 	DECIMAL point. Each address variable such as street address, company name, city, state, zip+4 zip code, and urbanization (where applicable) are analyzed to achieve an efficient geocode result.',	
// MAGIC `glbl_ult_ctry_cd` STRING COMMENT 'Global Ultimate Country Code: The country of the topmost firm of a global family tree group of companies.	',		
// MAGIC `glbl_ult_tuns_nbr` STRING COMMENT 'Global Ultimate DUNS number: The DUNS number of the upper most parent of a corporate family worldwide.',
// MAGIC `glbl_ult_fips_ctry_cd` STRING COMMENT 'Global Ultimate FIPS Country Code: Code for the country where the ultimate company is located. Blank if not linked.',
// MAGIC `glbl_ult_ind` STRING COMMENT 'Global Ultimate Indicator: If Y this site DUNS is the global ultimate otherwise N. Blank if not linked.',
// MAGIC `glbl_ult_nm` STRING COMMENT 'Global Ultimate Name: The primary name of the global ultimate business. Blank if not linked.',
// MAGIC `glbl_ult_st_abbr` STRING COMMENT 'Global Ultimate State Abbreviation: Name of the state or province in which the ultimate company is located. Blank if not linked.',
// MAGIC `hier_cd` STRING COMMENT 'Hiearchy Code: Determines the records relative position in a corporate hierarchy by indicating its relationship to other records. The hierarchy code functions in the following way: Global Ultimates have a hierarchy code of 01. Subsidiaries have a hierarchy code of one greater than their parents. Branches have a hierarchy code equal to their headquarters. The Hierarchy code values change based on the depth of the family trees in the data universe.',
// MAGIC `high_cr_avg_cd` STRING COMMENT 'Credit High Average: CSAD Data. Average High Credit. Its the average high credit given to an organization such as you would be allotted on a credit card. There is no finite list of possible values.',
// MAGIC `high_cr_max_cd` STRING COMMENT 'Credit High Maximum: CSAD Data. Maximum High Credit.',
// MAGIC `inqr_cont_serv_cnt` STRING COMMENT '',	
// MAGIC `iso_ctry_cd` STRING COMMENT 'ISO Country Code for the DUNS',
// MAGIC `iso_dom_ult_ctry_cd` STRING COMMENT 'ISO Country Code for the Domestic Ultimate DUNS',
// MAGIC `iso_glbl_ult_ctry_cd` STRING COMMENT 'ISO Country Code for the Global Ultimate DUNS',
// MAGIC `iso_hdqt_parnt_ctry_cd` STRING COMMENT 'ISO Country Code for the HQ/Par DUNS',
// MAGIC `jdgt_cnt` STRING COMMENT 'Judgements: A civil judgment is a final decision made by the court ordering a party to pay a specific amount as restitution for money owed as a result of monetary loss and damages. D&B collects about 80%-85% of all business related civil judgements filed at the state and federal court levels. Criminal judgements are not captured. If this is a branch location this is the total number of judgments for the headquarters location not the branch. In the case of a Headquarters location all judgements at the branch level will roll up to the respective HQ DUNS. There is no roll-up from Subsidiary to Parent as these are their own legal entity. Please note that these values can be different from Custom File Judgement Indicator.',
// MAGIC `jdgt_ind` STRING COMMENT 'Judgement Indicator: Y - indicates the presence at least one (1) open judgment against the establishment. This is the total number of judgements for this location regardless of the type of location (ie subsidiary branch etc). This carries the value for this location. A judgment remains open until a closed status update is collected from the courthouse. Not available for non-US entities.',
// MAGIC `lgl_nm` STRING COMMENT 'Legal Business Name: CSAD Data. Legal name of the business.',
// MAGIC `lgl_sts_cd` STRING COMMENT 'Legal Status Code: The Legal Status Of An Establishment - Proprietorship Partnership Or Corporation. Codes Are: 000 = NA 013 = Proprietorship 012 = Partnership 003 = Corporation',
// MAGIC `lgl_sts_chg_ind` STRING COMMENT 'Indicates whether there has been a change over the last month to the Legal Status. ',
// MAGIC `lien_cnt` STRING COMMENT 'Liens - Number of: This is the total number of liens for this location regardless of the type of location (ie subsidiary branch etc); this carries the value for this location. A lien is a claim or encumbrance that is held against the establishment until an outstanding debt or obligation has been satisfied. Most liens are for unpaid taxes. A lien remains open until a release update is collected from the courthouse. In the case of a Headquarters location all liens at the branch level will roll up to the respective HQ DUNS. There is no roll-up from Subsidiary to Parent as these are their own legal entity. All liens are removed frm the count once the obligation is fulfilled or a period of 10 years has passed.',
// MAGIC `lien_ind` STRING COMMENT 'Lien Indicator: Y = the presence of at least one (1) open lien against the establishment within the D&B file. A lien is a claim or encumbrance that is held against the establishment until an outstanding debt or obligation has been satisfied. Most liens are for unpaid taxes. A lien remains open until a release update is collected from the courthouse. Not available for non-US entities.',
// MAGIC `lngd_txt` STRING COMMENT 'Geo Info - Longitude Concatenated: Indicates the arc or portion of the earths equator intersected bewtween the median of the given place and the prime meridian. Information is provided by the system 	DECIMALs and Degrees.',	
// MAGIC `lob_abbr` STRING COMMENT 'Line of Business: Alpha narrative abbreviation of the type of work done at this location.',
// MAGIC `lttd_txt` STRING COMMENT 'Geo Info - Latitude Concatenated: Indicates angular distance north or south from the earths equator measured through 90 degrees. Includes + or - sign. Information is provided by the system 	DECIMALs and Degrees.',	
// MAGIC `mail_cnty_nm` STRING COMMENT 'The full name of the county where the business has its mail delivered. ',
// MAGIC `mail_cty_nm` STRING COMMENT 'Mailing Address City: The mailing city of the establishment some cities in the US are abbreviated.',
// MAGIC `mail_st_abbr` STRING COMMENT 'Mailing Address State Abbreviation: The two character abbreviation for the state abbreviation used by US Postal Service',
// MAGIC `mail_st_addr_1_txt` STRING COMMENT 'Mailing Address Street Address Line 1: The mail address of the site. Present only if the establishment is using a mailing address in addition to its physical address number (ie. Separate post office, etc.).',
// MAGIC `mail_st_addr_2_txt` STRING COMMENT 'Mailing Address Street Address Line 2: The second line of a mailing address for a particular business (e.g. Suite 2).',
// MAGIC `mail_zip_cd` STRING COMMENT 'Mailing Address Zip Postal Code: Zip code associated with the mailing address.',
// MAGIC `maj_ind_cat_cd` STRING COMMENT 'SIC - Major Industry Category Code: Code that denotes which major industry category an establishment falls under (agriculture, mining, construction, manufacturing, transportation, communications, utilities, wholesale trade, retail trade, finance, insurance, real eatate, services).',
// MAGIC `metro_stat_area_cd` STRING COMMENT 'Metropolitan Statistical Area Code: CSAD Data. The standard metropolitan statistical area was formerly used by the federal government for general statistic purposes. Last updated by the Federal Government in 1983.',
// MAGIC `mfr_ind` STRING COMMENT 'Manufacturing Indicator: Denotes Whether Manufacturing Occurs At The Site. 0= Manufacturing Is Done At The Location, 1 = No Manufacturing At This Location',
// MAGIC `minr_typ_cd` STRING COMMENT '"Indicates whether the business is owned by a member of a minority group.  Codes are:1=Not Minority Owned,2=Minority Owned."',
// MAGIC `mv_ind` STRING COMMENT 'Moved Indicator: CSAD Data. Company Moved. 0 = NO, 1 = YES.',
// MAGIC `naics_cd` STRING COMMENT 'NAICS Code: NAICS Classification Code. Not available for non-US entities.',
// MAGIC `naics_desc` STRING COMMENT 'NAICS Description: NAICS Classification Description. Not available for non-US entities.',
// MAGIC `nbr_fam_mbr_cnt` STRING COMMENT 'Family Tree - Number of Family Members: Total number of family members world wide.',
// MAGIC `nbr_past_due_cnt` STRING COMMENT 'Payment Experiences - Number Past Due: CSAD Data. Number of Payment Experiences Past Due. The number of trading relationships between the subject and its supplier where net terms are available. Absent means no CSAD record or no Payment Experiences on net terms.',
// MAGIC `nbr_pymt_exprs_cnt` STRING COMMENT 'Payment Experiences - Number of: CSAD Data. Number of Payment Experiences. The higher the number of trade experiences that D&B has reported on an individual business the lower the likelihood of risk. With the absence of trade information the model will rely upon other demographic and financial data available on a business. For branches this is the value for the headquarters.',
// MAGIC `nbr_pymt_exprs_pydx_cnt` STRING COMMENT 'Payment Experiences - Number of Paydex: CSAD Data. This field shows how many payment experiences were used in the calculation to create the Paydex score.',
// MAGIC `net_wrth_amt` STRING COMMENT 'Net Worth: CSAD Data. Company Net Worth. The retained profits and invested capital representing the equity of the business. Contains leading zeros and a leading negative sign. Any 15 digit numeric value except zero.',
// MAGIC `nixie_cd` STRING COMMENT 'Nixie Indicator: Nixies are business records that contain addresses identified as undeliverable: P = No Physical Address, M = No Mailing Address, B = No Physical or Mailing Address, Y = Nixie, N = Not a Nixie. Nixie records are excluded from the WorldBase Active and Marketable universes. D&B identify records as undeliverable in a variety of ways: Local Postal Service Information (US - USPS UK - Royal Mail). Customer Mail Returns sent back to D&B for review. Mail Returns from internal mailings. As part of the NCOA process, we will also tag records as Nixie if the forwarding address is listed as no forwarding address.',
// MAGIC `nixie_ind` STRING COMMENT 'Nixie Indicator: CSAD Data. Nixies are business records that contain addresses identified as undeliverable. 0 = No, 1 = Yes. Not available for non-US entities. Custom File.NIXIE is simply a yes or no indicator where Reference File.REF-NIXIE-IND is a breakout of specific nixie flags including whether or not something is a nixie.',
// MAGIC `non_cls_sic_ind` STRING COMMENT 'SIC Non-Classified Indicator: Unable to classify within D&B known industries. N: Everything OK, Y: As indicated. Note: Multiple rows may exist for a single DUNS on this table.',
// MAGIC `ntl_cd` STRING COMMENT 'A code value that describes the type of National ID number provided. For example 00012 = CRO, 00014 = Siren.',
// MAGIC `ntl_id_nbr` STRING COMMENT 'National Identification Number: The business identification number used in some countries for business registration and tax collection. Examples include CRO numbers in the U.K. and the French Siren numbers.',
// MAGIC `opert_fm_resd_ind` STRING COMMENT 'Operates From Residence Indicator: CSAD Data. Operates from residence indicator. 0 = NO, 1 = YES.',
// MAGIC `otf_busn_yy_mm_dd` STRING COMMENT 'Out of Business Date: CSAD Data. Date Company Went Out Of Business YYYYMMDD',
// MAGIC `own_ind` STRING COMMENT 'Owns Rents Indicator: CSAD Data. Indicates whether the entity owns the facility in which their business operates. 0 = NO, 1 = YES. This record carries the value for the HQ location on Branch records.',
// MAGIC `own_rent_ind` STRING COMMENT 'Owns Rents Indicator: Indicates Whether The Business Owns Or Rents The Building It Occupies. 0 = NA, 1 = Owns, 2 = Rents',
// MAGIC `parnt_tuns_nbr` STRING COMMENT 'Parent DUNS number: If this is a subsidiary record the DUNS number of the parent organizations HQ location will appear in this field. If not a subsidiary then the parent DUNS number field is blank.',
// MAGIC `parnt_hdqt_ctry_cd` STRING COMMENT 'ParentHQ Country Code: The country code of the ParentHQ of a subsidiary or branch.',
// MAGIC `parnt_hdqt_fips_ctry_cd` STRING COMMENT 'ParentHQ Country Code: The country code of the ParentHQ of a subsidiary or branch.',
// MAGIC `parnt_hdqt_nm` STRING COMMENT 'ParentHQ Name: The legal name of the ParentHQ business establishment that controls another company through ownership of all or a majority of its stock.',
// MAGIC `parnt_hdqt_st_nm` STRING COMMENT 'ParentHQ State: The state location of the ParentHQ of a subsidiary or branch.',
// MAGIC `past_due_amt` DECIMAL(38,16) COMMENT 'Total Amount Past Due: CSAD Data. Total Amount Past Due',
// MAGIC `pblc_prvt_cd` STRING COMMENT 'PublicPrivate Indicator: Indicator That Shows Whether The Business Is Publicly Or Privately Held 1=Public 2=Private ',
// MAGIC `phys_addr_st_abbr` STRING COMMENT 'Physical Address State Abbreviation: CSAD Data. The United States Postal Service (USPS) standard abbreviation denoted the state within which a particular business site is located. For branches this is the state code for the headquarters location. Need to check what is being used in the MDM ODS etc.',
// MAGIC `phys_addr_zip_cd` STRING COMMENT 'Physical Address Zip Postal Code: CSAD Data. 5-Digit Zip Code For branches this carries the value of the headquarters locations. Need to verify which is being used in the MDM ODS etc.',
// MAGIC `phys_cnty_nm` STRING COMMENT 'Physical Address County Name: The county where the establishment is located.',
// MAGIC `phys_cty_nm` STRING COMMENT 'Physical Address City: The city within which a particular business site is located.',
// MAGIC `phys_st_cd` STRING COMMENT 'Physical Address State Code: The United States Postal Service USPS standard abbreviation denoted the state within which a particular business site is located.',
// MAGIC `phys_strt_addr_1_txt` STRING COMMENT 'Physical Address Street Line 1: The street address associated with a particular business site.',
// MAGIC `phys_strt_addr_2_txt` STRING COMMENT 'Physical Address Street Line 2: This is the physical address line 2 of the establishment. Generally in local language.',
// MAGIC `phys_zip_cd` STRING COMMENT 'Physical Address Zip Postal Code: The zip plus four code of a particular business site is located.',
// MAGIC `pop_cd` STRING COMMENT 'Population Code: A Code Indicating The Residential Population Surrounding A Location In A Postal Zip Code Area.',
// MAGIC `pri_loc_acty_cd` STRING COMMENT 'Business identification number used in some countries for business registration and tax collection. Examples include CRO numbers in the U.K. and the French Siren numbers.',
// MAGIC `pri_sic_cd` STRING COMMENT 'SIC Primary with D&B Append: The Standard Industrial Classification (SIC) code, developed by the US Government, assigns a code to businesses and other organizations classifying and subdividing the activity performed by that establishment at that location. This is the eight-position primary SIC for this location. SICs are placed in the order of their reported contribution to an entities total revenues. Additional documentation on SIC assignment by D&B is available on the EIDM share directory under DnB KT.',
// MAGIC `pydx_1_pydx_24_cd` STRING COMMENT 'Paydex for the Last 24 months - Repeats 24 times - Oldest paydex is last.(PKDV)',
// MAGIC `pydx_nrml_cd` STRING COMMENT 'Paydex Score Industry Norm: CSAD Data. Industry Paydex norm.',
// MAGIC `pydx_refr_cnt` STRING COMMENT 'Pay References - Number of : CSAD Data. Number of Pay References.',
// MAGIC `pydx_scor_cd` STRING COMMENT 'Paydex Score: Current Financial Rating (0-100) assigned by D&B to connote how well and how fast a company pays it debts. 100= Anticipate, 90 = Discount, 80 = Prompt, 70 = Slow to 15 Days, 50 = Slow to 30 Days, 40 = Slow to 60 Days, 30 = Slow to 90 Days, 20 = Slow to 120 Days, 0 = Slow to over 120 Days, 998 = Not On Trade No Data, 999 = On Trade No Data. Not available for non-US entities.',
// MAGIC `pydx1_cd` STRING COMMENT 'Normalized Paydex 1 month ago',
// MAGIC `pydx10_cd` STRING COMMENT 'Normalized Paydex 10 month ago',
// MAGIC `pydx11_cd` STRING COMMENT 'Normalized Paydex 11 month ago',
// MAGIC `pydx12_cd` STRING COMMENT 'Normalized Paydex 12 month ago',
// MAGIC `pydx13_cd` STRING COMMENT 'Normalized Paydex 13 month ago',
// MAGIC `pydx14_cd` STRING COMMENT 'Normalized Paydex 14 month ago',
// MAGIC `pydx15_cd` STRING COMMENT 'Normalized Paydex 15 month ago',
// MAGIC `pydx16_cd` STRING COMMENT 'Normalized Paydex 16 month ago',
// MAGIC `pydx17_cd` STRING COMMENT 'Normalized Paydex 17 month ago',
// MAGIC `pydx18_cd` STRING COMMENT 'Normalized Paydex 18 month ago',
// MAGIC `pydx19_cd` STRING COMMENT 'Normalized Paydex 19 month ago',
// MAGIC `pydx2_cd` STRING COMMENT 'Normalized Paydex 2 month ago',
// MAGIC `pydx20_cd` STRING COMMENT 'Normalized Paydex 20 month ago',
// MAGIC `pydx21_cd` STRING COMMENT 'Normalized Paydex 21 month ago',
// MAGIC `pydx22_cd` STRING COMMENT 'Normalized Paydex 22 month ago',
// MAGIC `pydx23_cd` STRING COMMENT 'Normalized Paydex 23 month ago',
// MAGIC `pydx24_cd` STRING COMMENT 'Normalized Paydex 24 month ago',
// MAGIC `pydx3_cd` STRING COMMENT 'Normalized Paydex 3 month ago',
// MAGIC `pydx4_cd` STRING COMMENT 'Normalized Paydex 4 month ago',
// MAGIC `pydx5_cd` STRING COMMENT 'Normalized Paydex 5 month ago',
// MAGIC `pydx6_cd` STRING COMMENT 'Normalized Paydex 6 month ago',
// MAGIC `pydx7_cd` STRING COMMENT 'Normalized Paydex 7 month ago',
// MAGIC `pydx8_cd` STRING COMMENT 'Start in column 22 for a length of 3',
// MAGIC `pydx9_cd` STRING COMMENT 'Start in column 25 for a length of 3',
// MAGIC `pymt_expr_120_cnt` STRING COMMENT 'The number of payment experiences that are 120 days past due.',
// MAGIC `pymt_expr_180_cnt` STRING COMMENT 'The number of payment experiences that are 180 days past due.',
// MAGIC `pymt_expr_30_cnt` STRING COMMENT 'The number of payment experiences that are 30 days past due.',
// MAGIC `pymt_expr_60_cnt` STRING COMMENT 'The number of payment experiences that are 60 days past due.',
// MAGIC `pymt_expr_90_cnt` STRING COMMENT 'The number of payment experiences that are 90 days past due.',
// MAGIC `pymt_expr_999_cnt` STRING COMMENT 'The number of payment experiences that are over 180 days past due.',
// MAGIC `pymt_expr_cnt` STRING COMMENT 'Payment Experiences - Number of: Number of Payment Experiences. The higher the number of trade experiences that D&B has reported on an individual business the lower the likelihood of risk. With the absence of trade information the model will rely upon other demographic and financial data available on a business.',
// MAGIC `pymt_expr_neg_cd` STRING COMMENT 'Payment Experiences - Number of Negative: CSAD Data. Number of Negative Payment Experiences. The number of trading relationships between the subject and its suppliers that are derogatory obtained by summing the number of unique accounts for the purchaser that are viewed negatively. Accounts are considered derogatory when their payment comment expresses a failure of the purchaser to make payment. Examples of unfavorable conditions are accounts that have been placed for collection, accounts whose owed amount has been written off due to bad debt, accounts resulting in suits filed against the subject, accounts where credit has been refused by the supplier, accounts with unsatisfactory payments, accounts with insufficient funds, and accounts where the goods sold have been repossessed.',
// MAGIC `pymt_expr_slow_cd` STRING COMMENT 'Payment Experiences - Number of Slow: CSAD Data. Number of Slow Payment Experiences. The number of trading relationships between the subject and its suppliers that are past due obtained by summing the number of unique accounts for the purchaser that have a summarized experience that includes any slowness. For branches this carries the value for the headquarters location. Absent means no CSAD record or no slow experiences.',
// MAGIC `pymt_expr_slow_neg_cnt` STRING COMMENT 'Payment Experiences - Number of Negative and Slow: CSAD Data. Number of Negative and Slow Payment Experiences. The number of Trading relationships between the subject and its suppliers that have a summarized experience that includes any slowness or derogatory. If the summarized experience is slow, or viewed negatively, the experience is counted once. If the payment manner is split, for example Prompt - Slow, one half added to the count. They consist of overdue, unsatisfactory, bad debt, suit-filed, non-sufficient funds, credit refused, placed for collection, or repossession trade experiences. Absent means no CSAD or no slow or negative payment experiences.',
// MAGIC `pymt_expr_stsfctry_cnt` STRING COMMENT 'Payment Experiences - Number of Satisfactory (CSAD): CSAD Data. Number of Satisfactory Payment Experiences. The number of trading relationships between the subject and its supplier that are paid on time or viewed as satisfactory. Missing means no CSAD record or not satisfactory experiences.',
// MAGIC `rec_cls_cd` STRING COMMENT 'Record Class Code: Records in the D&B Marketing file are categorized into three classes of records: Class 0 - All businesses that at a minimum have a valid telephone, known SIC code, and a D&B rating that is not equal to DS; Class 1 - All businesses that at a minimum have a valid telephone, known SIC code, and a D&B rating that is equal to DS; Class 2 - All businesses which are missing a known SIC code and/or a valid telephone number. A D&B rating is not a qualifier for these businesses. Note: Multiple rows may exist for a single DUNS on this table.',
// MAGIC `refr_ctry_cd` STRING COMMENT 'D&B country code where this business is located',
// MAGIC `refr_ist_dt` STRING COMMENT 'Date record was inserted into the database',
// MAGIC `refr_loc_typ_cd` STRING COMMENT '"Code indicating the organizational status of the business entity: 0 = single location 1 = headquarters location 2 = branch location."',
// MAGIC `refr_tran_typ_cd` STRING COMMENT 'C=Change, A=Add, D=Delete  &  N=No change',
// MAGIC `refr_updt_dt` STRING COMMENT 'Date record was last updated. yyyymmdd, e.g., 20021126.',
// MAGIC `refr_updt_usr_id` STRING COMMENT '',		
// MAGIC `reg_inqr_cnt` STRING COMMENT 'Inquiries Number of Regular: CSAD Data. The total number of regular inquiries received by D&B over the previous 12 months. It is calculated by the number of D&B reports that have been ordered on the specific business. Indicates the number of times a business has been inquired upon by other D&B customers.',
// MAGIC `rent_ind` STRING COMMENT 'Rents Indicator: CSAD Data. Indicates whether the entity rents the facility: 0 = NO, 1 = YES.',
// MAGIC `scnd_exec_fst_nm` STRING COMMENT 'The first name of the individual identified as the third executive of the business.',
// MAGIC `scnd_exec_full_nm` STRING COMMENT 'The full name of the individual identified as the chief executive of the business.',
// MAGIC `scnd_exec_gndr_cd` STRING COMMENT 'The gender code of the individual identified as the second executive of the business:M = male F = female B = cannot be determined',
// MAGIC `scnd_exec_lst_nm` STRING COMMENT 'The last name of the individual identified as the second executive of the business.',
// MAGIC `scnd_exec_mgmt_resp_cd` STRING COMMENT 'Marketing Responsibility Order (MRC) A D&B Code that identifies the title of the individual identified as the second executive of the business, from the D‑U‑N‑S Decision Maker File.',
// MAGIC `scnd_exec_mid_init_abbr` STRING COMMENT 'The middle name of the individual identified as the second executive of the business.',
// MAGIC `scnd_exec_prfx_nm` STRING COMMENT 'A qualifier for the name of the individual identified as the second executive of the business: Mr., Mrs., Dr., etc.',
// MAGIC `scnd_exec_suff_nm` STRING COMMENT 'A qualifier that follows the name of the individual identified as the second executive of the business: Jr., Sr., MD., etc.',
// MAGIC `scnd_exec_ttl_nm` STRING COMMENT 'The title of the individual identified as the first executive of the business.',
// MAGIC `scnd_trd_styl_nm` STRING COMMENT 'An additional name used by a business for advertising and/or buying purposes.',
// MAGIC `sic_cd_gp_chg_ind` STRING COMMENT 'Indicates whether there has been a change over the last month with any of the following activity code-related fields: Line of Business SIC Base + up to 4 extensions Primary Local Activity Code',
// MAGIC `site_refr_extrc_load_and_trfm_bat_id` STRING COMMENT '',		
// MAGIC `site_refr_extrc_load_and_trfm_run_dt` STRING COMMENT '',		
// MAGIC `site_refr_otf_busn_cd` STRING COMMENT 'Out of Business Flag: Out of Business records will have the OB Inactive indicator and there are two types of conditions: Out of Business - A business which D&B has determined as out of business using at least 2 separate authorities to confirm. D&B determines business status through direct investigations and through its ongoing data maintenance processes. These records are removed from the U.S. Marketing file. Unable to Confirm Active Operations - A business which D&B has been unable to find evidence of active operations at the last known address on file. D&B determines business status through direct investigations and through its ongoing data maintenance processes. These records are removed from the U.S. Marketing file. From Site File',
// MAGIC `site_refr_rec_del_ind` STRING COMMENT 'Y If Deleted At Source Otherwise Blank From Site file',
// MAGIC `site_refr_tel_nbr` STRING COMMENT 'Telephone Number: The telephone number associated with a particular site.',
// MAGIC `site_refr_tixie_ind` STRING COMMENT 'Tixie Flag: Tixies are business records that contain a telephone number identified as no longer in service, or does not reach the business listed on the report. Tixie records are included in the WorldBase Active universe, but excluded from the WorldBase Marketable universe. From site reference file',
// MAGIC `site_sts_cd` STRING COMMENT 'Family Tree - Site Status Indicator: The organizational status at this location. 0 = This is a single location business, 1 = Headquarters location. It has one or more branches reporting to it. (Note: There is no parent code.), 2 = Branch location. It reports to a headquarters location',
// MAGIC `slow_pymt_expr_cnt` STRING COMMENT 'Payment Experiences - Number of Slow : Number of Slow Payment Experiences. This is the same as the Custom File.PAYEXP_S with the exception that this carries the value for the location regardless of the location type.',
// MAGIC `sls_amt` DECIMAL(38,16) COMMENT 'Sales Volume: CSAD Data. Total Reported Sales Volume.',
// MAGIC `sls_trnd_3_yy` STRING COMMENT 'The sales volume in the last year of a three year trend period.',
// MAGIC `sls_trnd_5_yy` STRING COMMENT 'The sales volume for the five-year trend period.',
// MAGIC `sls_vol_chg_ind` STRING COMMENT '',
// MAGIC `sls_volm_loc_amt` DECIMAL(38,16) COMMENT 'Sales - Annual Site Sales Local Currency: Sales for the business generally in local currency.',
// MAGIC `sls_volm_loc_cd` STRING COMMENT 'Sales - Annual Site Sales Local Currency Reliability Code: Code describing the sales volume. 0 = actual, 1 = low end of range, 2 = estimated or not available if sales value is zero.',
// MAGIC `sls_volm_us_amt` DECIMAL(38,16) COMMENT 'Sales Volume Total (US Dollars): Sales Volume represents the annual sales attributable to products and services sold by an organization annually. Sales Volume may be derived from sales gross revenue, commissions or billings. In our global products we provide both the local annual sales with a corresponding currency code, as well as the conversion to annual sales in U.S. dollars for easy comparison across all markets. Sales volume consists of sales at this location plus all the locations under it. For example a Parent with 2 subsidiaries would reflect the sales of all 3 locations. However this does cross borders. In our previous example, if the Parent and one of the Subsidiaries was in the US, and the other Subsidiary was in Canada, all 3 would still be reflected in the sales of the Parent. The sales on the Global Ultimate reflects the sales of all family members in the tree. Branch listing contains blanks.',
// MAGIC `sls_volm_us_cd` STRING COMMENT 'Code providing additional information about the domestic annual sales of the business: 0 = actual figure 1 = low end of range 2 = estimate/not available',
// MAGIC `small_busn_ind` STRING COMMENT 'Small Business Indicator: Indicates A Small Business Designation As Profiled By The Small Business Administration Of The Federal Government.',
// MAGIC `sq_ft_amt` STRING COMMENT 'Square Footage: The building space occupied by a place of business as measured in square feet.',
// MAGIC `st_nm` STRING COMMENT 'Physical Address State Name: The name of the stateprovincewithin which the record is located.',
// MAGIC `stmt_dt` STRING COMMENT 'Statement Date: CSAD Data. The date of the financial statement. Valid date value in the format YYYYMMDD.',
// MAGIC `stmt_ind` STRING COMMENT 'Statement Indicator: CSAD Data. Presence of a Financial Statement. Statements must be within 21 months old for contribution to D&B Rating or Scores. 0 = NO, 1 = YES.',
// MAGIC `stmt_typ_cd` STRING COMMENT 'Statement Type: CSAD Data. Statement Type: A = FISCAL, B = INTERIM, E = PRO FORMA, H = SIGNED EST, I = UNSIGNED EST, C = CONSOLIDATED, D = INDIVIDUAL, J = RESTATED, X = MINIMAL INTERIM, Y = MINIMAL FISCAL, O = NO START.',
// MAGIC `stp_ind` STRING COMMENT 'Stop Distribution Indicator: CSAD Data. This indicator identifies records that D&B temporarily removes from our online databases while the record is being investigated. For example if a record is suspected to be fraudulent, or if a customer claims something is seriously wrong with their record, D&B will put this on Stop Distribution until we can investigate and resolve. 0 = NO, 1 = YES.',
// MAGIC `str_yy` STRING COMMENT 'Year Business Started: In the original D&B configuration, the definition is \'The year when current ownership or management assumed control of the business\'. This is not provided for branch records, meaning the year the current owner or management took control of the business. However beginning February of 2011, when Farmers and  shared this file,  requested to overlay this field with Year Started, which is the year the business opened. It still contains the Actual Year Started. There have been no changes to this field in any Archived Data deliverables. Blanks or 0000 means that D&B does not know the start date, or that the record is a branch. D&B does not provide year started on branches.',
// MAGIC `subsdy_cd` STRING COMMENT 'Family Tree - Subsidiary Indicator: Duplicate of Append File.DATA-APP-SUBSIDIARY-IND.',
// MAGIC `suit_cnt` STRING COMMENT 'Suits Indicator: Y = indicates the presence at least one 1 open lawsuit against the establishment within the D&B file. A suit remains open until a closed status update is collected from the courthouse.',
// MAGIC `suit_ind` STRING COMMENT 'Suits Indicator: Y = indicates the presence at least one 1 open lawsuit against the establishment within the D&B file. A suit remains open until a closed status update is collected from the courthouse.',
// MAGIC `tel_nbr_chg_ind` STRING COMMENT '"Indicates whether there has been a change over the last month with one of the following fields related to Telecommunication numbers: Telephone Number Cable/Telex Number Facsimile Number" ',
// MAGIC `thr_yy_empe_grw_pct` STRING COMMENT 'Employee - 3 Year Growth Percentage Concatenated: Provides information on the total percent growth or decline in the number of employees over a three year period. Includes + or - sign. ',
// MAGIC `thr_yy_sls_grw_pct` STRING COMMENT 'Sales - Percentage Growth 3 yr Concatenated: Provides information on the total percent growth or decline in sales volume over a three year period. Includes + or - sign. ',
// MAGIC `thrd_exec_fst_nm` STRING COMMENT 'Third Executive First Name: The first name in a fixed field of the individual identified in the DUNS decision maker file. ',
// MAGIC `thrd_exec_full_nm` STRING COMMENT 'Third Executive Full Name: The First, Second & Third executive names are from D&B and appended as part of the standard IM process. This means the CEO is pulled as the top contact and then the three additional executive names are populated from our DDM (exec names) file, but there is no selection logic between the two that states if the 1st exec = CEO then don\'t use it; therefore in some cases the CEO and one of the executive names could be the same.',
// MAGIC `thrd_exec_gndr_cd` STRING COMMENT 'Third Executive Gender Code: The gender code of the individual identified as the third executive of the business.',
// MAGIC `thrd_exec_lst_nm` STRING COMMENT 'Third Executive Last name: The last name in a fixed field of the individual identified in the DUNS decision maker file.',
// MAGIC `thrd_exec_mgmt_resp_cd` STRING COMMENT 'Third Executive MRC: Management Responsibility Code MRC identifies the third executives title andor area of responsibility from the DUNS decision maker file.',
// MAGIC `thrd_exec_mid_init_abbr` STRING COMMENT 'Third Executive Middle Initial: The middle initial in a fixed field of the individual identified in the DUNS decision maker file.',
// MAGIC `thrd_exec_prfx_nm` STRING COMMENT 'Third Executive Prefix: A qualifier that precedes an individuals first name - examples are Mr., Mrs., Dr., etc.',
// MAGIC `thrd_exec_suff_nm` STRING COMMENT 'Third Executive Suffix: A qualifier that follows an individuals full name - examples are Jr., Sr., MD., etc.',
// MAGIC `thrd_exec_ttl_nm` STRING COMMENT 'Third Executive Titile: The abbreviated title of the indivudual at the site identified in the DUNS decision maker file.',
// MAGIC `thrd_trd_styl_nm` STRING COMMENT 'Trade Style #3: The tradestyle name is otherwise known as the doing business as name, and in many cases, it is the storefront name (ex. ABC Inc is the business name and they do business as - Bob\'s Bar and Grill.) We capture up to 5 names that the business is doing business as, in addition to the business name for most local and global products. For U.S. records, the Tradestyle Name is the doing business as name, as well as the common view name, which is the standardized view of the many variations of a franchise name. Example: McDonald\'s Store 185 is the business name and the common view name would be McDonald\'s. The common view name will only be found in the first tradestyle name field.',
// MAGIC `tot_empe_cnt` STRING COMMENT 'Employees - Total Number of : CSAD Data. Total Number of Employees Reported.',
// MAGIC `trd_styl_nm` STRING COMMENT 'Trade Style #1: The tradestyle name is otherwise known as the doing business as name, and in many cases, it is the storefront name (ex. ABC Inc is the business name and they do business as - Bob\'s Bar and Grill.) We capture up to 5 names that the business is doing business as, in addition to the business name for most local and global products. For U.S. records, the Tradestyle Name is the doing business as name, as well as the common view name, which is the standardized view of the many variations of a franchise name. Example: McDonald\'s Store 185 is the business name and the common view name would be McDonald\'s. The common view name will only be found in the first tradestyle name field.',
// MAGIC `ufav_bkrp_ind` STRING COMMENT 'Unfavorable Bankruptcy Flag: Unfavorable bankruptcy indicator. N - Everything OK, Y - As indicated. Reference File.REF-UNFAV-BNKRP-FLAG is a duplicate of Custom File. Bankruptcy Indicator.',
// MAGIC `unifrm_cml_cd_fl_cnt` STRING COMMENT 'UCC Filings - Number of: CSAD Data. Total Number of UCC Filings.',
// MAGIC `updt_dt` STRING COMMENT 'Date file was created',
// MAGIC `updt_usr_id` STRING COMMENT 'Update User ID Custom File: ID if the username that updated the record.Not available for non-US entities.',
// MAGIC `yy_str_chg_ind` STRING COMMENT 'Indicates whether there has been a change over the last month with one of the following date fields: Year Started Family Update Date',
// MAGIC `eff_fm_tistmp` STRING COMMENT 'The effective date and time that represents the beginning of the time period during which the values of all attributes of the entity occurrence are true in the business reality.',
// MAGIC `eff_to_tistmp` STRING COMMENT 'The effective date and time that represents the end of the time period during which the values of all attributes of the entity occurrence are true in the business reality.'
// MAGIC ) 
// MAGIC USING DELTA
// MAGIC COMMENT 'mm_delta table'
// MAGIC LOCATION '$adls_curtn_basepath/data/curated/stg/enterprise/af/mm_delta';

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC -- common curation max value storage table, contians PK and Business PK values for all curation jobs
// MAGIC -- table_identifier : is the curation SCD-2 table name, for which we want to generate and persist PK and ABK
// MAGIC CREATE TABLE IF NOT EXISTS $stg_db_name.stg_curtn_max_key_number(
// MAGIC `pk_max_val` BIGINT,
// MAGIC `abk_max_val` BIGINT,
// MAGIC `table_identifier` STRING
// MAGIC )
// MAGIC USING org.apache.spark.sql.parquet
// MAGIC PARTITIONED BY (`table_identifier`)
// MAGIC COMMENT 'primary key and alternate business key table for curation type-2 tables'
// MAGIC LOCATION '$adls_curtn_basepath/data/curated/stg/enterprise/af/stg_curtn_max_key_number'
// MAGIC TBLPROPERTIES ("parquet.compression"="SNAPPY");

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC INSERT OVERWRITE TABLE $stg_db_name.stg_curtn_max_key_number PARTITION (table_identifier="$tgt_table_name") 
// MAGIC SELECT COALESCE(MAX(tuns_pk), 0),COALESCE(MAX(tuns_alt_busn_key), 0)  FROM $stg_db_name.mm_delta;

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC use $stg_db_name;
// MAGIC MERGE INTO $stg_db_name.mm_delta
// MAGIC USING (
// MAGIC --de-activate/expire existing records for D and U type of latest records
// MAGIC SELECT 
// MAGIC /*+ SKEW('stg_cdc','tuns_nbr') */ 
// MAGIC tuns_nbr as mergeKey,
// MAGIC null as tuns_pk,
// MAGIC null as tuns_alt_busn_key,
// MAGIC null as tuns_nbr,
// MAGIC null as late_actv_rec_ind,
// MAGIC null as busn_actv_rec_ind,
// MAGIC null as act_firm_nm,
// MAGIC null as appd_fil_1_txt,
// MAGIC null as appd_fil_2_txt,
// MAGIC null as appd_empe_here_cnt,
// MAGIC null as appd_extrc_load_and_trfm_bat_id,
// MAGIC null as appd_extrc_load_and_trfm_run_dt,
// MAGIC null as appd_hdqt_tuns_nbr,
// MAGIC null as appd_import_eprt_cd,
// MAGIC null as appd_minr_ownd_ind,
// MAGIC null as appd_rec_del_ind,
// MAGIC null as appd_subsdy_ind,
// MAGIC null as base_catg_ind,
// MAGIC null as base_rpt_dt,
// MAGIC null as base_sls_yy_amt,
// MAGIC null as base_yy_empe_cnt,
// MAGIC null as bkrp_dt,
// MAGIC null as bnk_tuns_nbr,
// MAGIC null as burg_ind,
// MAGIC null as busn_nm,
// MAGIC null as carr_rout_cd,
// MAGIC null as cbl_telex_nbr,
// MAGIC null as ccs_cd,
// MAGIC null as ccs_vers_8_cd,
// MAGIC null as ccs_vers_8_pct_nbr,
// MAGIC null as ccs_vers_9_pct_nbr,
// MAGIC null as ccs_vers_9_pnt_cd,
// MAGIC null as ccs_vers_9_scor_cd,
// MAGIC null as chief_exec_ofcr_fst_nm,
// MAGIC null as chief_exec_ofcr_full_nm,
// MAGIC null as chief_exec_ofcr_gndr_cd,
// MAGIC null as chief_exec_ofcr_lst_nm,
// MAGIC null as chief_exec_ofcr_mgmt_resp_cd,
// MAGIC null as chief_exec_ofcr_mid_init_abbr,
// MAGIC null as chief_exec_ofcr_prfx_ttl_nm,
// MAGIC null as chief_exec_ofcr_suff_ttl_nm,
// MAGIC null as chief_exec_ofcr_ttl_abbr,
// MAGIC null as cml_cr_pct_nbr,
// MAGIC null as cmnl_prcd_ind,
// MAGIC null as cnda_ccs_pct_cd,
// MAGIC null as cnda_ccs_raw_scor_cd,
// MAGIC null as cnda_ccs_rsk_cls_cd,
// MAGIC null as cnda_finc_stmt_summ_pct_cd,
// MAGIC null as cnda_finc_stmt_summ_rsk_cls_cd,
// MAGIC null as cnty_cd,
// MAGIC null as co_ctry_nm,
// MAGIC null as co_nm,
// MAGIC null as co_str_yy,
// MAGIC null as co_typ_cd,
// MAGIC null as cond_ratg_cd,
// MAGIC null as cr_pnt_cd,
// MAGIC null as cr_ratg_cd,
// MAGIC null as cr_scor_cd,
// MAGIC null as cr_scor_vers_7_pct,
// MAGIC null as crcy_cd,
// MAGIC null as csad_bkrp_ind,
// MAGIC null as csad_data_hist_cd,
// MAGIC null as csad_lien_cnt,
// MAGIC null as csad_suit_cnt,
// MAGIC null as ctry_tel_acss_cd,
// MAGIC null as cty_map_cd,
// MAGIC null as cur_mgmt_str_yy,
// MAGIC null as custm_bkrp_ind,
// MAGIC null as custm_empe_here_cnt,
// MAGIC null as custm_extrc_load_and_trfm_bat_id,
// MAGIC null as custm_extrc_load_and_trfm_run_dt,
// MAGIC null as custm_fil_1_txt,
// MAGIC null as custm_hdqt_tuns_nbr,
// MAGIC null as custm_import_eprt_cd,
// MAGIC null as custm_minr_ownd_ind,
// MAGIC null as custm_otf_busn_ind,
// MAGIC null as custm_rec_del_ind,
// MAGIC null as custm_subsdy_ind,
// MAGIC null as custm_tel_nbr,
// MAGIC null as custm_tixie_ind,
// MAGIC null as data_appd_cnti_cd,
// MAGIC null as data_appd_st_nm,
// MAGIC null as data_appd_tel_nbr,
// MAGIC null as data_appd_updt_dt,
// MAGIC null as data_rep_dt,
// MAGIC null as data_updt_usr_id,
// MAGIC null as debt_ind,
// MAGIC null as dias_cd,
// MAGIC null as div_ind,
// MAGIC null as dlist_ind,
// MAGIC null as dom_ult_busn_nm,
// MAGIC null as dom_ult_ctry_cd,
// MAGIC null as dom_ult_tuns_nbr,
// MAGIC null as dom_ult_fips_ctry_cd,
// MAGIC null as dom_ult_st_abbr,
// MAGIC null as dt_ind,
// MAGIC null as due_thrty_dd_amt,
// MAGIC null as tuns_cr_ratg_cd,
// MAGIC null as dup_cur_mgmt_str_yy,
// MAGIC null as dup_jdgt_cnt,
// MAGIC null as econ_area_of_inflnc_cd,
// MAGIC null as empe_here_cd,
// MAGIC null as empe_tot_cd,
// MAGIC null as empe_tot_cnt,
// MAGIC null as empe_trnd_3_yy_cnt,
// MAGIC null as empe_trnd_5_yy_cnt,
// MAGIC null as equiv_annl_annty_stmt_dt,
// MAGIC null as equiv_annl_annty_typ_cd,
// MAGIC null as fax_nbr,
// MAGIC null as fein,
// MAGIC null as ffth_trd_styl_nm,
// MAGIC null as fil_10_txt,
// MAGIC null as fil_11_txt,
// MAGIC null as fil_12_txt,
// MAGIC null as fil_13_txt,
// MAGIC null as fil_14_txt,
// MAGIC null as fil_15_txt,
// MAGIC null as fil_16_txt,
// MAGIC null as fil_17_txt,
// MAGIC null as fil_2_txt,
// MAGIC null as fil_4_txt,
// MAGIC null as fil_5_txt,
// MAGIC null as fil_6_txt,
// MAGIC null as fil_7_txt,
// MAGIC null as fil_8_txt,
// MAGIC null as fil_9_txt,
// MAGIC null as finc_cd,
// MAGIC null as finc_strs_pct_nbr,
// MAGIC null as finc_strs_pnt_cd,
// MAGIC null as finc_strs_scor_cd,
// MAGIC null as finc_strs_scor_vers_7_1_cd,
// MAGIC null as finc_strs_scor_vers_7_1_pct_nbr,
// MAGIC null as finc_strs_scor_vers_7_cd,
// MAGIC null as finc_strs_vers_7_pct_nbr,
// MAGIC null as fips_cnty_cd,
// MAGIC null as fips_ctry_cd,
// MAGIC null as fips_metro_stat_area_cd,
// MAGIC null as fips_sdiv_1_cd,
// MAGIC null as fips_sdiv_2_cd,
// MAGIC null as fir_occr_ind,
// MAGIC null as five_yy_empe_grw_pct,
// MAGIC null as five_yy_sls_grw_pct,
// MAGIC null as frgn_fam_mbr_ind,
// MAGIC null as fst_exec_fst_nm,
// MAGIC null as fst_exec_full_nm,
// MAGIC null as fst_exec_gndr_cd,
// MAGIC null as fst_exec_lst_nm,
// MAGIC null as fst_exec_mgmt_resp_cd,
// MAGIC null as fst_exec_mid_init_abbr,
// MAGIC null as fst_exec_prfx_nm,
// MAGIC null as fst_exec_suff_nm,
// MAGIC null as fst_exec_ttl_nm,
// MAGIC null as fth_trd_styl_nm,
// MAGIC null as geo_lttd_lngd_accu_ind,
// MAGIC null as glbl_ult_ctry_cd,
// MAGIC null as glbl_ult_tuns_nbr,
// MAGIC null as glbl_ult_fips_ctry_cd,
// MAGIC null as glbl_ult_ind,
// MAGIC null as glbl_ult_nm,
// MAGIC null as glbl_ult_st_abbr,
// MAGIC null as hier_cd,
// MAGIC null as high_cr_avg_cd,
// MAGIC null as high_cr_max_cd,
// MAGIC null as inqr_cont_serv_cnt,
// MAGIC null as iso_ctry_cd,
// MAGIC null as iso_dom_ult_ctry_cd,
// MAGIC null as iso_glbl_ult_ctry_cd,
// MAGIC null as iso_hdqt_parnt_ctry_cd,
// MAGIC null as jdgt_cnt,
// MAGIC null as jdgt_ind,
// MAGIC null as lgl_nm,
// MAGIC null as lgl_sts_cd,
// MAGIC null as lgl_sts_chg_ind,
// MAGIC null as lien_cnt,
// MAGIC null as lien_ind,
// MAGIC null as lngd_txt,
// MAGIC null as lob_abbr,
// MAGIC null as lttd_txt,
// MAGIC null as mail_cnty_nm,
// MAGIC null as mail_cty_nm,
// MAGIC null as mail_st_abbr,
// MAGIC null as mail_st_addr_1_txt,
// MAGIC null as mail_st_addr_2_txt,
// MAGIC null as mail_zip_cd,
// MAGIC null as maj_ind_cat_cd,
// MAGIC null as metro_stat_area_cd,
// MAGIC null as mfr_ind,
// MAGIC null as minr_typ_cd,
// MAGIC null as mv_ind,
// MAGIC null as naics_cd,
// MAGIC null as naics_desc,
// MAGIC null as nbr_fam_mbr_cnt,
// MAGIC null as nbr_past_due_cnt,
// MAGIC null as nbr_pymt_exprs_cnt,
// MAGIC null as nbr_pymt_exprs_pydx_cnt,
// MAGIC null as net_wrth_amt,
// MAGIC null as nixie_cd,
// MAGIC null as nixie_ind,
// MAGIC null as non_cls_sic_ind,
// MAGIC null as ntl_cd,
// MAGIC null as ntl_id_nbr,
// MAGIC null as opert_fm_resd_ind,
// MAGIC null as otf_busn_yy_mm_dd,
// MAGIC null as own_ind,
// MAGIC null as own_rent_ind,
// MAGIC null as parnt_tuns_nbr,
// MAGIC null as parnt_hdqt_ctry_cd,
// MAGIC null as parnt_hdqt_fips_ctry_cd,
// MAGIC null as parnt_hdqt_nm,
// MAGIC null as parnt_hdqt_st_nm,
// MAGIC null as past_due_amt,
// MAGIC null as pblc_prvt_cd,
// MAGIC null as phys_addr_st_abbr,
// MAGIC null as phys_addr_zip_cd,
// MAGIC null as phys_cnty_nm,
// MAGIC null as phys_cty_nm,
// MAGIC null as phys_st_cd,
// MAGIC null as phys_strt_addr_1_txt,
// MAGIC null as phys_strt_addr_2_txt,
// MAGIC null as phys_zip_cd,
// MAGIC null as pop_cd,
// MAGIC null as pri_loc_acty_cd,
// MAGIC null as pri_sic_cd,
// MAGIC null as pydx_1_pydx_24_cd,
// MAGIC null as pydx_nrml_cd,
// MAGIC null as pydx_refr_cnt,
// MAGIC null as pydx_scor_cd,
// MAGIC null as pydx1_cd,
// MAGIC null as pydx10_cd,
// MAGIC null as pydx11_cd,
// MAGIC null as pydx12_cd,
// MAGIC null as pydx13_cd,
// MAGIC null as pydx14_cd,
// MAGIC null as pydx15_cd,
// MAGIC null as pydx16_cd,
// MAGIC null as pydx17_cd,
// MAGIC null as pydx18_cd,
// MAGIC null as pydx19_cd,
// MAGIC null as pydx2_cd,
// MAGIC null as pydx20_cd,
// MAGIC null as pydx21_cd,
// MAGIC null as pydx22_cd,
// MAGIC null as pydx23_cd,
// MAGIC null as pydx24_cd,
// MAGIC null as pydx3_cd,
// MAGIC null as pydx4_cd,
// MAGIC null as pydx5_cd,
// MAGIC null as pydx6_cd,
// MAGIC null as pydx7_cd,
// MAGIC null as pydx8_cd,
// MAGIC null as pydx9_cd,
// MAGIC null as pymt_expr_120_cnt,
// MAGIC null as pymt_expr_180_cnt,
// MAGIC null as pymt_expr_30_cnt,
// MAGIC null as pymt_expr_60_cnt,
// MAGIC null as pymt_expr_90_cnt,
// MAGIC null as pymt_expr_999_cnt,
// MAGIC null as pymt_expr_cnt,
// MAGIC null as pymt_expr_neg_cd,
// MAGIC null as pymt_expr_slow_cd,
// MAGIC null as pymt_expr_slow_neg_cnt,
// MAGIC null as pymt_expr_stsfctry_cnt,
// MAGIC null as rec_cls_cd,
// MAGIC null as refr_ctry_cd,
// MAGIC null as refr_ist_dt,
// MAGIC null as refr_loc_typ_cd,
// MAGIC null as refr_tran_typ_cd,
// MAGIC null as refr_updt_dt,
// MAGIC null as refr_updt_usr_id,
// MAGIC null as reg_inqr_cnt,
// MAGIC null as rent_ind,
// MAGIC null as scnd_exec_fst_nm,
// MAGIC null as scnd_exec_full_nm,
// MAGIC null as scnd_exec_gndr_cd,
// MAGIC null as scnd_exec_lst_nm,
// MAGIC null as scnd_exec_mgmt_resp_cd,
// MAGIC null as scnd_exec_mid_init_abbr,
// MAGIC null as scnd_exec_prfx_nm,
// MAGIC null as scnd_exec_suff_nm,
// MAGIC null as scnd_exec_ttl_nm,
// MAGIC null as scnd_trd_styl_nm,
// MAGIC null as sic_cd_gp_chg_ind,
// MAGIC null as site_refr_extrc_load_and_trfm_bat_id,
// MAGIC null as site_refr_extrc_load_and_trfm_run_dt,
// MAGIC null as site_refr_otf_busn_cd,
// MAGIC null as site_refr_rec_del_ind,
// MAGIC null as site_refr_tel_nbr,
// MAGIC null as site_refr_tixie_ind,
// MAGIC null as site_sts_cd,
// MAGIC null as slow_pymt_expr_cnt,
// MAGIC null as sls_amt,
// MAGIC null as sls_trnd_3_yy,
// MAGIC null as sls_trnd_5_yy,
// MAGIC null as sls_vol_chg_ind,
// MAGIC null as sls_volm_loc_amt,
// MAGIC null as sls_volm_loc_cd,
// MAGIC null as sls_volm_us_amt,
// MAGIC null as sls_volm_us_cd,
// MAGIC null as small_busn_ind,
// MAGIC null as sq_ft_amt,
// MAGIC null as st_nm,
// MAGIC null as stmt_dt,
// MAGIC null as stmt_ind,
// MAGIC null as stmt_typ_cd,
// MAGIC null as stp_ind,
// MAGIC null as str_yy,
// MAGIC null as subsdy_cd,
// MAGIC null as suit_cnt,
// MAGIC null as suit_ind,
// MAGIC null as tel_nbr_chg_ind,
// MAGIC null as thr_yy_empe_grw_pct,
// MAGIC null as thr_yy_sls_grw_pct,
// MAGIC null as thrd_exec_fst_nm,
// MAGIC null as thrd_exec_full_nm,
// MAGIC null as thrd_exec_gndr_cd,
// MAGIC null as thrd_exec_lst_nm,
// MAGIC null as thrd_exec_mgmt_resp_cd,
// MAGIC null as thrd_exec_mid_init_abbr,
// MAGIC null as thrd_exec_prfx_nm,
// MAGIC null as thrd_exec_suff_nm,
// MAGIC null as thrd_exec_ttl_nm,
// MAGIC null as thrd_trd_styl_nm,
// MAGIC null as tot_empe_cnt,
// MAGIC null as trd_styl_nm,
// MAGIC null as ufav_bkrp_ind,
// MAGIC null as unifrm_cml_cd_fl_cnt,
// MAGIC null as updt_dt,
// MAGIC null as updt_usr_id,
// MAGIC null as yy_str_chg_ind,
// MAGIC null as eff_fm_tistmp,
// MAGIC null as eff_to_tistmp,
// MAGIC type
// MAGIC FROM $stg_db_name.stg_cdc
// MAGIC WHERE type in ('U','D') and prcs_dt="$process_date"
// MAGIC   
// MAGIC --Re-Inserts : expire/de-activate deleted record in case of re-insertion of deleted tuns_nbr
// MAGIC UNION ALL
// MAGIC 
// MAGIC SELECT 
// MAGIC /*+ SKEW('cdc','tuns_nbr') */ 
// MAGIC cdc.tuns_nbr as mergeKey,
// MAGIC null as tuns_pk,
// MAGIC null as tuns_alt_busn_key,
// MAGIC null as tuns_nbr,
// MAGIC null as late_actv_rec_ind,
// MAGIC null as busn_actv_rec_ind,
// MAGIC null as act_firm_nm,
// MAGIC null as appd_fil_1_txt,
// MAGIC null as appd_fil_2_txt,
// MAGIC null as appd_empe_here_cnt,
// MAGIC null as appd_extrc_load_and_trfm_bat_id,
// MAGIC null as appd_extrc_load_and_trfm_run_dt,
// MAGIC null as appd_hdqt_tuns_nbr,
// MAGIC null as appd_import_eprt_cd,
// MAGIC null as appd_minr_ownd_ind,
// MAGIC null as appd_rec_del_ind,
// MAGIC null as appd_subsdy_ind,
// MAGIC null as base_catg_ind,
// MAGIC null as base_rpt_dt,
// MAGIC null as base_sls_yy_amt,
// MAGIC null as base_yy_empe_cnt,
// MAGIC null as bkrp_dt,
// MAGIC null as bnk_tuns_nbr,
// MAGIC null as burg_ind,
// MAGIC null as busn_nm,
// MAGIC null as carr_rout_cd,
// MAGIC null as cbl_telex_nbr,
// MAGIC null as ccs_cd,
// MAGIC null as ccs_vers_8_cd,
// MAGIC null as ccs_vers_8_pct_nbr,
// MAGIC null as ccs_vers_9_pct_nbr,
// MAGIC null as ccs_vers_9_pnt_cd,
// MAGIC null as ccs_vers_9_scor_cd,
// MAGIC null as chief_exec_ofcr_fst_nm,
// MAGIC null as chief_exec_ofcr_full_nm,
// MAGIC null as chief_exec_ofcr_gndr_cd,
// MAGIC null as chief_exec_ofcr_lst_nm,
// MAGIC null as chief_exec_ofcr_mgmt_resp_cd,
// MAGIC null as chief_exec_ofcr_mid_init_abbr,
// MAGIC null as chief_exec_ofcr_prfx_ttl_nm,
// MAGIC null as chief_exec_ofcr_suff_ttl_nm,
// MAGIC null as chief_exec_ofcr_ttl_abbr,
// MAGIC null as cml_cr_pct_nbr,
// MAGIC null as cmnl_prcd_ind,
// MAGIC null as cnda_ccs_pct_cd,
// MAGIC null as cnda_ccs_raw_scor_cd,
// MAGIC null as cnda_ccs_rsk_cls_cd,
// MAGIC null as cnda_finc_stmt_summ_pct_cd,
// MAGIC null as cnda_finc_stmt_summ_rsk_cls_cd,
// MAGIC null as cnty_cd,
// MAGIC null as co_ctry_nm,
// MAGIC null as co_nm,
// MAGIC null as co_str_yy,
// MAGIC null as co_typ_cd,
// MAGIC null as cond_ratg_cd,
// MAGIC null as cr_pnt_cd,
// MAGIC null as cr_ratg_cd,
// MAGIC null as cr_scor_cd,
// MAGIC null as cr_scor_vers_7_pct,
// MAGIC null as crcy_cd,
// MAGIC null as csad_bkrp_ind,
// MAGIC null as csad_data_hist_cd,
// MAGIC null as csad_lien_cnt,
// MAGIC null as csad_suit_cnt,
// MAGIC null as ctry_tel_acss_cd,
// MAGIC null as cty_map_cd,
// MAGIC null as cur_mgmt_str_yy,
// MAGIC null as custm_bkrp_ind,
// MAGIC null as custm_empe_here_cnt,
// MAGIC null as custm_extrc_load_and_trfm_bat_id,
// MAGIC null as custm_extrc_load_and_trfm_run_dt,
// MAGIC null as custm_fil_1_txt,
// MAGIC null as custm_hdqt_tuns_nbr,
// MAGIC null as custm_import_eprt_cd,
// MAGIC null as custm_minr_ownd_ind,
// MAGIC null as custm_otf_busn_ind,
// MAGIC null as custm_rec_del_ind,
// MAGIC null as custm_subsdy_ind,
// MAGIC null as custm_tel_nbr,
// MAGIC null as custm_tixie_ind,
// MAGIC null as data_appd_cnti_cd,
// MAGIC null as data_appd_st_nm,
// MAGIC null as data_appd_tel_nbr,
// MAGIC null as data_appd_updt_dt,
// MAGIC null as data_rep_dt,
// MAGIC null as data_updt_usr_id,
// MAGIC null as debt_ind,
// MAGIC null as dias_cd,
// MAGIC null as div_ind,
// MAGIC null as dlist_ind,
// MAGIC null as dom_ult_busn_nm,
// MAGIC null as dom_ult_ctry_cd,
// MAGIC null as dom_ult_tuns_nbr,
// MAGIC null as dom_ult_fips_ctry_cd,
// MAGIC null as dom_ult_st_abbr,
// MAGIC null as dt_ind,
// MAGIC null as due_thrty_dd_amt,
// MAGIC null as tuns_cr_ratg_cd,
// MAGIC null as dup_cur_mgmt_str_yy,
// MAGIC null as dup_jdgt_cnt,
// MAGIC null as econ_area_of_inflnc_cd,
// MAGIC null as empe_here_cd,
// MAGIC null as empe_tot_cd,
// MAGIC null as empe_tot_cnt,
// MAGIC null as empe_trnd_3_yy_cnt,
// MAGIC null as empe_trnd_5_yy_cnt,
// MAGIC null as equiv_annl_annty_stmt_dt,
// MAGIC null as equiv_annl_annty_typ_cd,
// MAGIC null as fax_nbr,
// MAGIC null as fein,
// MAGIC null as ffth_trd_styl_nm,
// MAGIC null as fil_10_txt,
// MAGIC null as fil_11_txt,
// MAGIC null as fil_12_txt,
// MAGIC null as fil_13_txt,
// MAGIC null as fil_14_txt,
// MAGIC null as fil_15_txt,
// MAGIC null as fil_16_txt,
// MAGIC null as fil_17_txt,
// MAGIC null as fil_2_txt,
// MAGIC null as fil_4_txt,
// MAGIC null as fil_5_txt,
// MAGIC null as fil_6_txt,
// MAGIC null as fil_7_txt,
// MAGIC null as fil_8_txt,
// MAGIC null as fil_9_txt,
// MAGIC null as finc_cd,
// MAGIC null as finc_strs_pct_nbr,
// MAGIC null as finc_strs_pnt_cd,
// MAGIC null as finc_strs_scor_cd,
// MAGIC null as finc_strs_scor_vers_7_1_cd,
// MAGIC null as finc_strs_scor_vers_7_1_pct_nbr,
// MAGIC null as finc_strs_scor_vers_7_cd,
// MAGIC null as finc_strs_vers_7_pct_nbr,
// MAGIC null as fips_cnty_cd,
// MAGIC null as fips_ctry_cd,
// MAGIC null as fips_metro_stat_area_cd,
// MAGIC null as fips_sdiv_1_cd,
// MAGIC null as fips_sdiv_2_cd,
// MAGIC null as fir_occr_ind,
// MAGIC null as five_yy_empe_grw_pct,
// MAGIC null as five_yy_sls_grw_pct,
// MAGIC null as frgn_fam_mbr_ind,
// MAGIC null as fst_exec_fst_nm,
// MAGIC null as fst_exec_full_nm,
// MAGIC null as fst_exec_gndr_cd,
// MAGIC null as fst_exec_lst_nm,
// MAGIC null as fst_exec_mgmt_resp_cd,
// MAGIC null as fst_exec_mid_init_abbr,
// MAGIC null as fst_exec_prfx_nm,
// MAGIC null as fst_exec_suff_nm,
// MAGIC null as fst_exec_ttl_nm,
// MAGIC null as fth_trd_styl_nm,
// MAGIC null as geo_lttd_lngd_accu_ind,
// MAGIC null as glbl_ult_ctry_cd,
// MAGIC null as glbl_ult_tuns_nbr,
// MAGIC null as glbl_ult_fips_ctry_cd,
// MAGIC null as glbl_ult_ind,
// MAGIC null as glbl_ult_nm,
// MAGIC null as glbl_ult_st_abbr,
// MAGIC null as hier_cd,
// MAGIC null as high_cr_avg_cd,
// MAGIC null as high_cr_max_cd,
// MAGIC null as inqr_cont_serv_cnt,
// MAGIC null as iso_ctry_cd,
// MAGIC null as iso_dom_ult_ctry_cd,
// MAGIC null as iso_glbl_ult_ctry_cd,
// MAGIC null as iso_hdqt_parnt_ctry_cd,
// MAGIC null as jdgt_cnt,
// MAGIC null as jdgt_ind,
// MAGIC null as lgl_nm,
// MAGIC null as lgl_sts_cd,
// MAGIC null as lgl_sts_chg_ind,
// MAGIC null as lien_cnt,
// MAGIC null as lien_ind,
// MAGIC null as lngd_txt,
// MAGIC null as lob_abbr,
// MAGIC null as lttd_txt,
// MAGIC null as mail_cnty_nm,
// MAGIC null as mail_cty_nm,
// MAGIC null as mail_st_abbr,
// MAGIC null as mail_st_addr_1_txt,
// MAGIC null as mail_st_addr_2_txt,
// MAGIC null as mail_zip_cd,
// MAGIC null as maj_ind_cat_cd,
// MAGIC null as metro_stat_area_cd,
// MAGIC null as mfr_ind,
// MAGIC null as minr_typ_cd,
// MAGIC null as mv_ind,
// MAGIC null as naics_cd,
// MAGIC null as naics_desc,
// MAGIC null as nbr_fam_mbr_cnt,
// MAGIC null as nbr_past_due_cnt,
// MAGIC null as nbr_pymt_exprs_cnt,
// MAGIC null as nbr_pymt_exprs_pydx_cnt,
// MAGIC null as net_wrth_amt,
// MAGIC null as nixie_cd,
// MAGIC null as nixie_ind,
// MAGIC null as non_cls_sic_ind,
// MAGIC null as ntl_cd,
// MAGIC null as ntl_id_nbr,
// MAGIC null as opert_fm_resd_ind,
// MAGIC null as otf_busn_yy_mm_dd,
// MAGIC null as own_ind,
// MAGIC null as own_rent_ind,
// MAGIC null as parnt_tuns_nbr,
// MAGIC null as parnt_hdqt_ctry_cd,
// MAGIC null as parnt_hdqt_fips_ctry_cd,
// MAGIC null as parnt_hdqt_nm,
// MAGIC null as parnt_hdqt_st_nm,
// MAGIC null as past_due_amt,
// MAGIC null as pblc_prvt_cd,
// MAGIC null as phys_addr_st_abbr,
// MAGIC null as phys_addr_zip_cd,
// MAGIC null as phys_cnty_nm,
// MAGIC null as phys_cty_nm,
// MAGIC null as phys_st_cd,
// MAGIC null as phys_strt_addr_1_txt,
// MAGIC null as phys_strt_addr_2_txt,
// MAGIC null as phys_zip_cd,
// MAGIC null as pop_cd,
// MAGIC null as pri_loc_acty_cd,
// MAGIC null as pri_sic_cd,
// MAGIC null as pydx_1_pydx_24_cd,
// MAGIC null as pydx_nrml_cd,
// MAGIC null as pydx_refr_cnt,
// MAGIC null as pydx_scor_cd,
// MAGIC null as pydx1_cd,
// MAGIC null as pydx10_cd,
// MAGIC null as pydx11_cd,
// MAGIC null as pydx12_cd,
// MAGIC null as pydx13_cd,
// MAGIC null as pydx14_cd,
// MAGIC null as pydx15_cd,
// MAGIC null as pydx16_cd,
// MAGIC null as pydx17_cd,
// MAGIC null as pydx18_cd,
// MAGIC null as pydx19_cd,
// MAGIC null as pydx2_cd,
// MAGIC null as pydx20_cd,
// MAGIC null as pydx21_cd,
// MAGIC null as pydx22_cd,
// MAGIC null as pydx23_cd,
// MAGIC null as pydx24_cd,
// MAGIC null as pydx3_cd,
// MAGIC null as pydx4_cd,
// MAGIC null as pydx5_cd,
// MAGIC null as pydx6_cd,
// MAGIC null as pydx7_cd,
// MAGIC null as pydx8_cd,
// MAGIC null as pydx9_cd,
// MAGIC null as pymt_expr_120_cnt,
// MAGIC null as pymt_expr_180_cnt,
// MAGIC null as pymt_expr_30_cnt,
// MAGIC null as pymt_expr_60_cnt,
// MAGIC null as pymt_expr_90_cnt,
// MAGIC null as pymt_expr_999_cnt,
// MAGIC null as pymt_expr_cnt,
// MAGIC null as pymt_expr_neg_cd,
// MAGIC null as pymt_expr_slow_cd,
// MAGIC null as pymt_expr_slow_neg_cnt,
// MAGIC null as pymt_expr_stsfctry_cnt,
// MAGIC null as rec_cls_cd,
// MAGIC null as refr_ctry_cd,
// MAGIC null as refr_ist_dt,
// MAGIC null as refr_loc_typ_cd,
// MAGIC null as refr_tran_typ_cd,
// MAGIC null as refr_updt_dt,
// MAGIC null as refr_updt_usr_id,
// MAGIC null as reg_inqr_cnt,
// MAGIC null as rent_ind,
// MAGIC null as scnd_exec_fst_nm,
// MAGIC null as scnd_exec_full_nm,
// MAGIC null as scnd_exec_gndr_cd,
// MAGIC null as scnd_exec_lst_nm,
// MAGIC null as scnd_exec_mgmt_resp_cd,
// MAGIC null as scnd_exec_mid_init_abbr,
// MAGIC null as scnd_exec_prfx_nm,
// MAGIC null as scnd_exec_suff_nm,
// MAGIC null as scnd_exec_ttl_nm,
// MAGIC null as scnd_trd_styl_nm,
// MAGIC null as sic_cd_gp_chg_ind,
// MAGIC null as site_refr_extrc_load_and_trfm_bat_id,
// MAGIC null as site_refr_extrc_load_and_trfm_run_dt,
// MAGIC null as site_refr_otf_busn_cd,
// MAGIC null as site_refr_rec_del_ind,
// MAGIC null as site_refr_tel_nbr,
// MAGIC null as site_refr_tixie_ind,
// MAGIC null as site_sts_cd,
// MAGIC null as slow_pymt_expr_cnt,
// MAGIC null as sls_amt,
// MAGIC null as sls_trnd_3_yy,
// MAGIC null as sls_trnd_5_yy,
// MAGIC null as sls_vol_chg_ind,
// MAGIC null as sls_volm_loc_amt,
// MAGIC null as sls_volm_loc_cd,
// MAGIC null as sls_volm_us_amt,
// MAGIC null as sls_volm_us_cd,
// MAGIC null as small_busn_ind,
// MAGIC null as sq_ft_amt,
// MAGIC null as st_nm,
// MAGIC null as stmt_dt,
// MAGIC null as stmt_ind,
// MAGIC null as stmt_typ_cd,
// MAGIC null as stp_ind,
// MAGIC null as str_yy,
// MAGIC null as subsdy_cd,
// MAGIC null as suit_cnt,
// MAGIC null as suit_ind,
// MAGIC null as tel_nbr_chg_ind,
// MAGIC null as thr_yy_empe_grw_pct,
// MAGIC null as thr_yy_sls_grw_pct,
// MAGIC null as thrd_exec_fst_nm,
// MAGIC null as thrd_exec_full_nm,
// MAGIC null as thrd_exec_gndr_cd,
// MAGIC null as thrd_exec_lst_nm,
// MAGIC null as thrd_exec_mgmt_resp_cd,
// MAGIC null as thrd_exec_mid_init_abbr,
// MAGIC null as thrd_exec_prfx_nm,
// MAGIC null as thrd_exec_suff_nm,
// MAGIC null as thrd_exec_ttl_nm,
// MAGIC null as thrd_trd_styl_nm,
// MAGIC null as tot_empe_cnt,
// MAGIC null as trd_styl_nm,
// MAGIC null as ufav_bkrp_ind,
// MAGIC null as unifrm_cml_cd_fl_cnt,
// MAGIC null as updt_dt,
// MAGIC null as updt_usr_id,
// MAGIC null as yy_str_chg_ind,
// MAGIC null as eff_fm_tistmp,
// MAGIC null as eff_to_tistmp,
// MAGIC 'RI' as type
// MAGIC from
// MAGIC (select 
// MAGIC /*+ SKEW('stg_cdc','tuns_nbr') */ 
// MAGIC tuns_nbr FROM $stg_db_name.stg_cdc WHERE type='I' and prcs_dt="$process_date") as cdc
// MAGIC INNER JOIN 
// MAGIC --select deleted tuns_nbr from delta table
// MAGIC (select 
// MAGIC /*+ SKEW('mm_delta','tuns_nbr') */ 
// MAGIC tuns_nbr from $stg_db_name.mm_delta where busn_actv_rec_ind='N' and late_actv_rec_ind='Y') as dim_del
// MAGIC ON (cdc.tuns_nbr=dim_del.tuns_nbr)
// MAGIC 
// MAGIC UNION ALL 
// MAGIC --prepare active records for I, U, D, and re-inserts 
// MAGIC SELECT 
// MAGIC null as mergeKey,
// MAGIC (m.pk_max_val + row_number() over (order by cdc.tuns_nbr)) as tuns_pk, 
// MAGIC case when cdc.type IN ('U', 'D') OR (cdc.type='I' and d.busn_actv_rec_ind='N') then d.tuns_alt_busn_key else (m.abk_max_val+row_number() over (order by cdc.type_order asc, cdc.tuns_nbr asc)) end as tuns_alt_busn_key,
// MAGIC cdc.tuns_nbr, 
// MAGIC 'Y' as late_actv_rec_ind,
// MAGIC case when cdc.type='D' then 'N' else 'Y' end as busn_actv_rec_ind,
// MAGIC cdc.act_firm_nm,
// MAGIC cdc.appd_fil_1_txt,
// MAGIC cdc.appd_fil_2_txt,
// MAGIC cdc.appd_empe_here_cnt,
// MAGIC cdc.appd_extrc_load_and_trfm_bat_id,
// MAGIC cdc.appd_extrc_load_and_trfm_run_dt,
// MAGIC cdc.appd_hdqt_tuns_nbr,
// MAGIC cdc.appd_import_eprt_cd,
// MAGIC cdc.appd_minr_ownd_ind,
// MAGIC cdc.appd_rec_del_ind,
// MAGIC cdc.appd_subsdy_ind,
// MAGIC cdc.base_catg_ind,
// MAGIC cdc.base_rpt_dt,
// MAGIC cdc.base_sls_yy_amt,
// MAGIC cdc.base_yy_empe_cnt,
// MAGIC cdc.bkrp_dt,
// MAGIC cdc.bnk_tuns_nbr,
// MAGIC cdc.burg_ind,
// MAGIC cdc.busn_nm,
// MAGIC cdc.carr_rout_cd,
// MAGIC cdc.cbl_telex_nbr,
// MAGIC cdc.ccs_cd,
// MAGIC cdc.ccs_vers_8_cd,
// MAGIC cdc.ccs_vers_8_pct_nbr,
// MAGIC cdc.ccs_vers_9_pct_nbr,
// MAGIC cdc.ccs_vers_9_pnt_cd,
// MAGIC cdc.ccs_vers_9_scor_cd,
// MAGIC cdc.chief_exec_ofcr_fst_nm,
// MAGIC cdc.chief_exec_ofcr_full_nm,
// MAGIC cdc.chief_exec_ofcr_gndr_cd,
// MAGIC cdc.chief_exec_ofcr_lst_nm,
// MAGIC cdc.chief_exec_ofcr_mgmt_resp_cd,
// MAGIC cdc.chief_exec_ofcr_mid_init_abbr,
// MAGIC cdc.chief_exec_ofcr_prfx_ttl_nm,
// MAGIC cdc.chief_exec_ofcr_suff_ttl_nm,
// MAGIC cdc.chief_exec_ofcr_ttl_abbr,
// MAGIC cdc.cml_cr_pct_nbr,
// MAGIC cdc.cmnl_prcd_ind,
// MAGIC cdc.cnda_ccs_pct_cd,
// MAGIC cdc.cnda_ccs_raw_scor_cd,
// MAGIC cdc.cnda_ccs_rsk_cls_cd,
// MAGIC cdc.cnda_finc_stmt_summ_pct_cd,
// MAGIC cdc.cnda_finc_stmt_summ_rsk_cls_cd,
// MAGIC cdc.cnty_cd,
// MAGIC cdc.co_ctry_nm,
// MAGIC cdc.co_nm,
// MAGIC cdc.co_str_yy,
// MAGIC cdc.co_typ_cd,
// MAGIC cdc.cond_ratg_cd,
// MAGIC cdc.cr_pnt_cd,
// MAGIC cdc.cr_ratg_cd,
// MAGIC cdc.cr_scor_cd,
// MAGIC cdc.cr_scor_vers_7_pct,
// MAGIC cdc.crcy_cd,
// MAGIC cdc.csad_bkrp_ind,
// MAGIC cdc.csad_data_hist_cd,
// MAGIC cdc.csad_lien_cnt,
// MAGIC cdc.csad_suit_cnt,
// MAGIC cdc.ctry_tel_acss_cd,
// MAGIC cdc.cty_map_cd,
// MAGIC cdc.cur_mgmt_str_yy,
// MAGIC cdc.custm_bkrp_ind,
// MAGIC cdc.custm_empe_here_cnt,
// MAGIC cdc.custm_extrc_load_and_trfm_bat_id,
// MAGIC cdc.custm_extrc_load_and_trfm_run_dt,
// MAGIC cdc.custm_fil_1_txt,
// MAGIC cdc.custm_hdqt_tuns_nbr,
// MAGIC cdc.custm_import_eprt_cd,
// MAGIC cdc.custm_minr_ownd_ind,
// MAGIC cdc.custm_otf_busn_ind,
// MAGIC cdc.custm_rec_del_ind,
// MAGIC cdc.custm_subsdy_ind,
// MAGIC cdc.custm_tel_nbr,
// MAGIC cdc.custm_tixie_ind,
// MAGIC cdc.data_appd_cnti_cd,
// MAGIC cdc.data_appd_st_nm,
// MAGIC cdc.data_appd_tel_nbr,
// MAGIC cdc.data_appd_updt_dt,
// MAGIC cdc.data_rep_dt,
// MAGIC cdc.data_updt_usr_id,
// MAGIC cdc.debt_ind,
// MAGIC cdc.dias_cd,
// MAGIC cdc.div_ind,
// MAGIC cdc.dlist_ind,
// MAGIC cdc.dom_ult_busn_nm,
// MAGIC cdc.dom_ult_ctry_cd,
// MAGIC cdc.dom_ult_tuns_nbr,
// MAGIC cdc.dom_ult_fips_ctry_cd,
// MAGIC cdc.dom_ult_st_abbr,
// MAGIC cdc.dt_ind,
// MAGIC cdc.due_thrty_dd_amt,
// MAGIC cdc.tuns_cr_ratg_cd,
// MAGIC cdc.dup_cur_mgmt_str_yy,
// MAGIC cdc.dup_jdgt_cnt,
// MAGIC cdc.econ_area_of_inflnc_cd,
// MAGIC cdc.empe_here_cd,
// MAGIC cdc.empe_tot_cd,
// MAGIC cdc.empe_tot_cnt,
// MAGIC cdc.empe_trnd_3_yy_cnt,
// MAGIC cdc.empe_trnd_5_yy_cnt,
// MAGIC cdc.equiv_annl_annty_stmt_dt,
// MAGIC cdc.equiv_annl_annty_typ_cd,
// MAGIC cdc.fax_nbr,
// MAGIC cdc.fein,
// MAGIC cdc.ffth_trd_styl_nm,
// MAGIC cdc.fil_10_txt,
// MAGIC cdc.fil_11_txt,
// MAGIC cdc.fil_12_txt,
// MAGIC cdc.fil_13_txt,
// MAGIC cdc.fil_14_txt,
// MAGIC cdc.fil_15_txt,
// MAGIC cdc.fil_16_txt,
// MAGIC cdc.fil_17_txt,
// MAGIC cdc.fil_2_txt,
// MAGIC cdc.fil_4_txt,
// MAGIC cdc.fil_5_txt,
// MAGIC cdc.fil_6_txt,
// MAGIC cdc.fil_7_txt,
// MAGIC cdc.fil_8_txt,
// MAGIC cdc.fil_9_txt,
// MAGIC cdc.finc_cd,
// MAGIC cdc.finc_strs_pct_nbr,
// MAGIC cdc.finc_strs_pnt_cd,
// MAGIC cdc.finc_strs_scor_cd,
// MAGIC cdc.finc_strs_scor_vers_7_1_cd,
// MAGIC cdc.finc_strs_scor_vers_7_1_pct_nbr,
// MAGIC cdc.finc_strs_scor_vers_7_cd,
// MAGIC cdc.finc_strs_vers_7_pct_nbr,
// MAGIC cdc.fips_cnty_cd,
// MAGIC cdc.fips_ctry_cd,
// MAGIC cdc.fips_metro_stat_area_cd,
// MAGIC cdc.fips_sdiv_1_cd,
// MAGIC cdc.fips_sdiv_2_cd,
// MAGIC cdc.fir_occr_ind,
// MAGIC cdc.five_yy_empe_grw_pct,
// MAGIC cdc.five_yy_sls_grw_pct,
// MAGIC cdc.frgn_fam_mbr_ind,
// MAGIC cdc.fst_exec_fst_nm,
// MAGIC cdc.fst_exec_full_nm,
// MAGIC cdc.fst_exec_gndr_cd,
// MAGIC cdc.fst_exec_lst_nm,
// MAGIC cdc.fst_exec_mgmt_resp_cd,
// MAGIC cdc.fst_exec_mid_init_abbr,
// MAGIC cdc.fst_exec_prfx_nm,
// MAGIC cdc.fst_exec_suff_nm,
// MAGIC cdc.fst_exec_ttl_nm,
// MAGIC cdc.fth_trd_styl_nm,
// MAGIC cdc.geo_lttd_lngd_accu_ind,
// MAGIC cdc.glbl_ult_ctry_cd,
// MAGIC cdc.glbl_ult_tuns_nbr,
// MAGIC cdc.glbl_ult_fips_ctry_cd,
// MAGIC cdc.glbl_ult_ind,
// MAGIC cdc.glbl_ult_nm,
// MAGIC cdc.glbl_ult_st_abbr,
// MAGIC cdc.hier_cd,
// MAGIC cdc.high_cr_avg_cd,
// MAGIC cdc.high_cr_max_cd,
// MAGIC cdc.inqr_cont_serv_cnt,
// MAGIC cdc.iso_ctry_cd,
// MAGIC cdc.iso_dom_ult_ctry_cd,
// MAGIC cdc.iso_glbl_ult_ctry_cd,
// MAGIC cdc.iso_hdqt_parnt_ctry_cd,
// MAGIC cdc.jdgt_cnt,
// MAGIC cdc.jdgt_ind,
// MAGIC cdc.lgl_nm,
// MAGIC cdc.lgl_sts_cd,
// MAGIC cdc.lgl_sts_chg_ind,
// MAGIC cdc.lien_cnt,
// MAGIC cdc.lien_ind,
// MAGIC cdc.lngd_txt,
// MAGIC cdc.lob_abbr,
// MAGIC cdc.lttd_txt,
// MAGIC cdc.mail_cnty_nm,
// MAGIC cdc.mail_cty_nm,
// MAGIC cdc.mail_st_abbr,
// MAGIC cdc.mail_st_addr_1_txt,
// MAGIC cdc.mail_st_addr_2_txt,
// MAGIC cdc.mail_zip_cd,
// MAGIC cdc.maj_ind_cat_cd,
// MAGIC cdc.metro_stat_area_cd,
// MAGIC cdc.mfr_ind,
// MAGIC cdc.minr_typ_cd,
// MAGIC cdc.mv_ind,
// MAGIC cdc.naics_cd,
// MAGIC cdc.naics_desc,
// MAGIC cdc.nbr_fam_mbr_cnt,
// MAGIC cdc.nbr_past_due_cnt,
// MAGIC cdc.nbr_pymt_exprs_cnt,
// MAGIC cdc.nbr_pymt_exprs_pydx_cnt,
// MAGIC cdc.net_wrth_amt,
// MAGIC cdc.nixie_cd,
// MAGIC cdc.nixie_ind,
// MAGIC cdc.non_cls_sic_ind,
// MAGIC cdc.ntl_cd,
// MAGIC cdc.ntl_id_nbr,
// MAGIC cdc.opert_fm_resd_ind,
// MAGIC cdc.otf_busn_yy_mm_dd,
// MAGIC cdc.own_ind,
// MAGIC cdc.own_rent_ind,
// MAGIC cdc.parnt_tuns_nbr,
// MAGIC cdc.parnt_hdqt_ctry_cd,
// MAGIC cdc.parnt_hdqt_fips_ctry_cd,
// MAGIC cdc.parnt_hdqt_nm,
// MAGIC cdc.parnt_hdqt_st_nm,
// MAGIC cdc.past_due_amt,
// MAGIC cdc.pblc_prvt_cd,
// MAGIC cdc.phys_addr_st_abbr,
// MAGIC cdc.phys_addr_zip_cd,
// MAGIC cdc.phys_cnty_nm,
// MAGIC cdc.phys_cty_nm,
// MAGIC cdc.phys_st_cd,
// MAGIC cdc.phys_strt_addr_1_txt,
// MAGIC cdc.phys_strt_addr_2_txt,
// MAGIC cdc.phys_zip_cd,
// MAGIC cdc.pop_cd,
// MAGIC cdc.pri_loc_acty_cd,
// MAGIC cdc.pri_sic_cd,
// MAGIC cdc.pydx_1_pydx_24_cd,
// MAGIC cdc.pydx_nrml_cd,
// MAGIC cdc.pydx_refr_cnt,
// MAGIC cdc.pydx_scor_cd,
// MAGIC cdc.pydx1_cd,
// MAGIC cdc.pydx10_cd,
// MAGIC cdc.pydx11_cd,
// MAGIC cdc.pydx12_cd,
// MAGIC cdc.pydx13_cd,
// MAGIC cdc.pydx14_cd,
// MAGIC cdc.pydx15_cd,
// MAGIC cdc.pydx16_cd,
// MAGIC cdc.pydx17_cd,
// MAGIC cdc.pydx18_cd,
// MAGIC cdc.pydx19_cd,
// MAGIC cdc.pydx2_cd,
// MAGIC cdc.pydx20_cd,
// MAGIC cdc.pydx21_cd,
// MAGIC cdc.pydx22_cd,
// MAGIC cdc.pydx23_cd,
// MAGIC cdc.pydx24_cd,
// MAGIC cdc.pydx3_cd,
// MAGIC cdc.pydx4_cd,
// MAGIC cdc.pydx5_cd,
// MAGIC cdc.pydx6_cd,
// MAGIC cdc.pydx7_cd,
// MAGIC cdc.pydx8_cd,
// MAGIC cdc.pydx9_cd,
// MAGIC cdc.pymt_expr_120_cnt,
// MAGIC cdc.pymt_expr_180_cnt,
// MAGIC cdc.pymt_expr_30_cnt,
// MAGIC cdc.pymt_expr_60_cnt,
// MAGIC cdc.pymt_expr_90_cnt,
// MAGIC cdc.pymt_expr_999_cnt,
// MAGIC cdc.pymt_expr_cnt,
// MAGIC cdc.pymt_expr_neg_cd,
// MAGIC cdc.pymt_expr_slow_cd,
// MAGIC cdc.pymt_expr_slow_neg_cnt,
// MAGIC cdc.pymt_expr_stsfctry_cnt,
// MAGIC cdc.rec_cls_cd,
// MAGIC cdc.refr_ctry_cd,
// MAGIC cdc.refr_ist_dt,
// MAGIC cdc.refr_loc_typ_cd,
// MAGIC cdc.refr_tran_typ_cd,
// MAGIC cdc.refr_updt_dt,
// MAGIC cdc.refr_updt_usr_id,
// MAGIC cdc.reg_inqr_cnt,
// MAGIC cdc.rent_ind,
// MAGIC cdc.scnd_exec_fst_nm,
// MAGIC cdc.scnd_exec_full_nm,
// MAGIC cdc.scnd_exec_gndr_cd,
// MAGIC cdc.scnd_exec_lst_nm,
// MAGIC cdc.scnd_exec_mgmt_resp_cd,
// MAGIC cdc.scnd_exec_mid_init_abbr,
// MAGIC cdc.scnd_exec_prfx_nm,
// MAGIC cdc.scnd_exec_suff_nm,
// MAGIC cdc.scnd_exec_ttl_nm,
// MAGIC cdc.scnd_trd_styl_nm,
// MAGIC cdc.sic_cd_gp_chg_ind,
// MAGIC cdc.site_refr_extrc_load_and_trfm_bat_id,
// MAGIC cdc.site_refr_extrc_load_and_trfm_run_dt,
// MAGIC cdc.site_refr_otf_busn_cd,
// MAGIC cdc.site_refr_rec_del_ind,
// MAGIC cdc.site_refr_tel_nbr,
// MAGIC cdc.site_refr_tixie_ind,
// MAGIC cdc.site_sts_cd,
// MAGIC cdc.slow_pymt_expr_cnt,
// MAGIC cdc.sls_amt,
// MAGIC cdc.sls_trnd_3_yy,
// MAGIC cdc.sls_trnd_5_yy,
// MAGIC cdc.sls_vol_chg_ind,
// MAGIC cdc.sls_volm_loc_amt,
// MAGIC cdc.sls_volm_loc_cd,
// MAGIC cdc.sls_volm_us_amt,
// MAGIC cdc.sls_volm_us_cd,
// MAGIC cdc.small_busn_ind,
// MAGIC cdc.sq_ft_amt,
// MAGIC cdc.st_nm,
// MAGIC cdc.stmt_dt,
// MAGIC cdc.stmt_ind,
// MAGIC cdc.stmt_typ_cd,
// MAGIC cdc.stp_ind,
// MAGIC cdc.str_yy,
// MAGIC cdc.subsdy_cd,
// MAGIC cdc.suit_cnt,
// MAGIC cdc.suit_ind,
// MAGIC cdc.tel_nbr_chg_ind,
// MAGIC cdc.thr_yy_empe_grw_pct,
// MAGIC cdc.thr_yy_sls_grw_pct,
// MAGIC cdc.thrd_exec_fst_nm,
// MAGIC cdc.thrd_exec_full_nm,
// MAGIC cdc.thrd_exec_gndr_cd,
// MAGIC cdc.thrd_exec_lst_nm,
// MAGIC cdc.thrd_exec_mgmt_resp_cd,
// MAGIC cdc.thrd_exec_mid_init_abbr,
// MAGIC cdc.thrd_exec_prfx_nm,
// MAGIC cdc.thrd_exec_suff_nm,
// MAGIC cdc.thrd_exec_ttl_nm,
// MAGIC cdc.thrd_trd_styl_nm,
// MAGIC cdc.tot_empe_cnt,
// MAGIC cdc.trd_styl_nm,
// MAGIC cdc.ufav_bkrp_ind,
// MAGIC cdc.unifrm_cml_cd_fl_cnt,
// MAGIC cdc.updt_dt,
// MAGIC cdc.updt_usr_id,
// MAGIC cdc.yy_str_chg_ind,
// MAGIC prcs_dt as eff_fm_tistmp,
// MAGIC '2999-12-31' as eff_to_tistmp, 
// MAGIC cdc.type 
// MAGIC FROM (
// MAGIC select *, 
// MAGIC case when type='I' then 1
// MAGIC when type='U' then 2
// MAGIC when type='D' then 3 end as type_order from $stg_db_name.stg_cdc where prcs_dt="$process_date") cdc
// MAGIC LEFT OUTER JOIN (select 
// MAGIC /*+ SKEW('mm_delta' ,'tuns_nbr') */ 
// MAGIC tuns_nbr, tuns_alt_busn_key, busn_actv_rec_ind from $stg_db_name.mm_delta where late_actv_rec_ind='Y') d
// MAGIC ON (cdc.tuns_nbr = d.tuns_nbr)
// MAGIC CROSS JOIN (select pk_max_val, abk_max_val from $stg_db_name.stg_curtn_max_key_number where 
// MAGIC table_identifier="$tgt_table_name") m
// MAGIC ) stg_dim_duns
// MAGIC ON mm_delta.tuns_nbr = mergeKey AND mm_delta.late_actv_rec_ind = 'Y' 
// MAGIC WHEN MATCHED and stg_dim_duns.type <> 'I' THEN UPDATE SET late_actv_rec_ind = 'N', eff_to_tistmp = "$process_date" 
// MAGIC WHEN NOT MATCHED THEN INSERT 
// MAGIC (tuns_pk,tuns_alt_busn_key,tuns_nbr,late_actv_rec_ind,busn_actv_rec_ind,act_firm_nm,appd_fil_1_txt,appd_fil_2_txt,appd_empe_here_cnt,appd_extrc_load_and_trfm_bat_id,appd_extrc_load_and_trfm_run_dt,appd_hdqt_tuns_nbr,appd_import_eprt_cd,appd_minr_ownd_ind,appd_rec_del_ind,appd_subsdy_ind,base_catg_ind,base_rpt_dt,base_sls_yy_amt,base_yy_empe_cnt,bkrp_dt,bnk_tuns_nbr,burg_ind,busn_nm,carr_rout_cd,cbl_telex_nbr,ccs_cd,ccs_vers_8_cd,ccs_vers_8_pct_nbr,ccs_vers_9_pct_nbr,ccs_vers_9_pnt_cd,ccs_vers_9_scor_cd,chief_exec_ofcr_fst_nm,chief_exec_ofcr_full_nm,chief_exec_ofcr_gndr_cd,chief_exec_ofcr_lst_nm,chief_exec_ofcr_mgmt_resp_cd,chief_exec_ofcr_mid_init_abbr,chief_exec_ofcr_prfx_ttl_nm,chief_exec_ofcr_suff_ttl_nm,chief_exec_ofcr_ttl_abbr,cml_cr_pct_nbr,cmnl_prcd_ind,cnda_ccs_pct_cd,cnda_ccs_raw_scor_cd,cnda_ccs_rsk_cls_cd,cnda_finc_stmt_summ_pct_cd,cnda_finc_stmt_summ_rsk_cls_cd,cnty_cd,co_ctry_nm,co_nm,co_str_yy,co_typ_cd,cond_ratg_cd,cr_pnt_cd,cr_ratg_cd,cr_scor_cd,cr_scor_vers_7_pct,crcy_cd,csad_bkrp_ind,csad_data_hist_cd,csad_lien_cnt,csad_suit_cnt,ctry_tel_acss_cd,cty_map_cd,cur_mgmt_str_yy,custm_bkrp_ind,custm_empe_here_cnt,custm_extrc_load_and_trfm_bat_id,custm_extrc_load_and_trfm_run_dt,custm_fil_1_txt,custm_hdqt_tuns_nbr,custm_import_eprt_cd,custm_minr_ownd_ind,custm_otf_busn_ind,custm_rec_del_ind,custm_subsdy_ind,custm_tel_nbr,custm_tixie_ind,data_appd_cnti_cd,data_appd_st_nm,data_appd_tel_nbr,data_appd_updt_dt,data_rep_dt,data_updt_usr_id,debt_ind,dias_cd,div_ind,dlist_ind,dom_ult_busn_nm,dom_ult_ctry_cd,dom_ult_tuns_nbr,dom_ult_fips_ctry_cd,dom_ult_st_abbr,dt_ind,due_thrty_dd_amt,tuns_cr_ratg_cd,dup_cur_mgmt_str_yy,dup_jdgt_cnt,econ_area_of_inflnc_cd,empe_here_cd,empe_tot_cd,empe_tot_cnt,empe_trnd_3_yy_cnt,empe_trnd_5_yy_cnt,equiv_annl_annty_stmt_dt,equiv_annl_annty_typ_cd,fax_nbr,fein,ffth_trd_styl_nm,fil_10_txt,fil_11_txt,fil_12_txt,fil_13_txt,fil_14_txt,fil_15_txt,fil_16_txt,fil_17_txt,fil_2_txt,fil_4_txt,fil_5_txt,fil_6_txt,fil_7_txt,fil_8_txt,fil_9_txt,finc_cd,finc_strs_pct_nbr,finc_strs_pnt_cd,finc_strs_scor_cd,finc_strs_scor_vers_7_1_cd,finc_strs_scor_vers_7_1_pct_nbr,finc_strs_scor_vers_7_cd,finc_strs_vers_7_pct_nbr,fips_cnty_cd,fips_ctry_cd,fips_metro_stat_area_cd,fips_sdiv_1_cd,fips_sdiv_2_cd,fir_occr_ind,five_yy_empe_grw_pct,five_yy_sls_grw_pct,frgn_fam_mbr_ind,fst_exec_fst_nm,fst_exec_full_nm,fst_exec_gndr_cd,fst_exec_lst_nm,fst_exec_mgmt_resp_cd,fst_exec_mid_init_abbr,fst_exec_prfx_nm,fst_exec_suff_nm,fst_exec_ttl_nm,fth_trd_styl_nm,geo_lttd_lngd_accu_ind,glbl_ult_ctry_cd,glbl_ult_tuns_nbr,glbl_ult_fips_ctry_cd,glbl_ult_ind,glbl_ult_nm,glbl_ult_st_abbr,hier_cd,high_cr_avg_cd,high_cr_max_cd,inqr_cont_serv_cnt,iso_ctry_cd,iso_dom_ult_ctry_cd,iso_glbl_ult_ctry_cd,iso_hdqt_parnt_ctry_cd,jdgt_cnt,jdgt_ind,lgl_nm,lgl_sts_cd,lgl_sts_chg_ind,lien_cnt,lien_ind,lngd_txt,lob_abbr,lttd_txt,mail_cnty_nm,mail_cty_nm,mail_st_abbr,mail_st_addr_1_txt,mail_st_addr_2_txt,mail_zip_cd,maj_ind_cat_cd,metro_stat_area_cd,mfr_ind,minr_typ_cd,mv_ind,naics_cd,naics_desc,nbr_fam_mbr_cnt,nbr_past_due_cnt,nbr_pymt_exprs_cnt,nbr_pymt_exprs_pydx_cnt,net_wrth_amt,nixie_cd,nixie_ind,non_cls_sic_ind,ntl_cd,ntl_id_nbr,opert_fm_resd_ind,otf_busn_yy_mm_dd,own_ind,own_rent_ind,parnt_tuns_nbr,parnt_hdqt_ctry_cd,parnt_hdqt_fips_ctry_cd,parnt_hdqt_nm,parnt_hdqt_st_nm,past_due_amt,pblc_prvt_cd,phys_addr_st_abbr,phys_addr_zip_cd,phys_cnty_nm,phys_cty_nm,phys_st_cd,phys_strt_addr_1_txt,phys_strt_addr_2_txt,phys_zip_cd,pop_cd,pri_loc_acty_cd,pri_sic_cd,pydx_1_pydx_24_cd,pydx_nrml_cd,pydx_refr_cnt,pydx_scor_cd,pydx1_cd,pydx10_cd,pydx11_cd,pydx12_cd,pydx13_cd,pydx14_cd,pydx15_cd,pydx16_cd,pydx17_cd,pydx18_cd,pydx19_cd,pydx2_cd,pydx20_cd,pydx21_cd,pydx22_cd,pydx23_cd,pydx24_cd,pydx3_cd,pydx4_cd,pydx5_cd,pydx6_cd,pydx7_cd,pydx8_cd,pydx9_cd,pymt_expr_120_cnt,pymt_expr_180_cnt,pymt_expr_30_cnt,pymt_expr_60_cnt,pymt_expr_90_cnt,pymt_expr_999_cnt,pymt_expr_cnt,pymt_expr_neg_cd,pymt_expr_slow_cd,pymt_expr_slow_neg_cnt,pymt_expr_stsfctry_cnt,rec_cls_cd,refr_ctry_cd,refr_ist_dt,refr_loc_typ_cd,refr_tran_typ_cd,refr_updt_dt,refr_updt_usr_id,reg_inqr_cnt,rent_ind,scnd_exec_fst_nm,scnd_exec_full_nm,scnd_exec_gndr_cd,scnd_exec_lst_nm,scnd_exec_mgmt_resp_cd,scnd_exec_mid_init_abbr,scnd_exec_prfx_nm,scnd_exec_suff_nm,scnd_exec_ttl_nm,scnd_trd_styl_nm,sic_cd_gp_chg_ind,site_refr_extrc_load_and_trfm_bat_id,site_refr_extrc_load_and_trfm_run_dt,site_refr_otf_busn_cd,site_refr_rec_del_ind,site_refr_tel_nbr,site_refr_tixie_ind,site_sts_cd,slow_pymt_expr_cnt,sls_amt,sls_trnd_3_yy,sls_trnd_5_yy,sls_vol_chg_ind,sls_volm_loc_amt,sls_volm_loc_cd,sls_volm_us_amt,sls_volm_us_cd,small_busn_ind,sq_ft_amt,st_nm,stmt_dt,stmt_ind,stmt_typ_cd,stp_ind,str_yy,subsdy_cd,suit_cnt,suit_ind,tel_nbr_chg_ind,thr_yy_empe_grw_pct,thr_yy_sls_grw_pct,thrd_exec_fst_nm,thrd_exec_full_nm,thrd_exec_gndr_cd,thrd_exec_lst_nm,thrd_exec_mgmt_resp_cd,thrd_exec_mid_init_abbr,thrd_exec_prfx_nm,thrd_exec_suff_nm,thrd_exec_ttl_nm,thrd_trd_styl_nm,tot_empe_cnt,trd_styl_nm,ufav_bkrp_ind,unifrm_cml_cd_fl_cnt,updt_dt,updt_usr_id,yy_str_chg_ind,eff_fm_tistmp,eff_to_tistmp)
// MAGIC VALUES
// MAGIC (stg_dim_duns.tuns_pk,stg_dim_duns.tuns_alt_busn_key,stg_dim_duns.tuns_nbr,stg_dim_duns.late_actv_rec_ind,stg_dim_duns.busn_actv_rec_ind,stg_dim_duns.act_firm_nm,stg_dim_duns.appd_fil_1_txt,stg_dim_duns.appd_fil_2_txt,stg_dim_duns.appd_empe_here_cnt,stg_dim_duns.appd_extrc_load_and_trfm_bat_id,stg_dim_duns.appd_extrc_load_and_trfm_run_dt,stg_dim_duns.appd_hdqt_tuns_nbr,stg_dim_duns.appd_import_eprt_cd,stg_dim_duns.appd_minr_ownd_ind,stg_dim_duns.appd_rec_del_ind,stg_dim_duns.appd_subsdy_ind,stg_dim_duns.base_catg_ind,stg_dim_duns.base_rpt_dt,stg_dim_duns.base_sls_yy_amt,stg_dim_duns.base_yy_empe_cnt,stg_dim_duns.bkrp_dt,stg_dim_duns.bnk_tuns_nbr,stg_dim_duns.burg_ind,stg_dim_duns.busn_nm,stg_dim_duns.carr_rout_cd,stg_dim_duns.cbl_telex_nbr,stg_dim_duns.ccs_cd,stg_dim_duns.ccs_vers_8_cd,stg_dim_duns.ccs_vers_8_pct_nbr,stg_dim_duns.ccs_vers_9_pct_nbr,stg_dim_duns.ccs_vers_9_pnt_cd,stg_dim_duns.ccs_vers_9_scor_cd,stg_dim_duns.chief_exec_ofcr_fst_nm,stg_dim_duns.chief_exec_ofcr_full_nm,stg_dim_duns.chief_exec_ofcr_gndr_cd,stg_dim_duns.chief_exec_ofcr_lst_nm,stg_dim_duns.chief_exec_ofcr_mgmt_resp_cd,stg_dim_duns.chief_exec_ofcr_mid_init_abbr,stg_dim_duns.chief_exec_ofcr_prfx_ttl_nm,stg_dim_duns.chief_exec_ofcr_suff_ttl_nm,stg_dim_duns.chief_exec_ofcr_ttl_abbr,stg_dim_duns.cml_cr_pct_nbr,stg_dim_duns.cmnl_prcd_ind,stg_dim_duns.cnda_ccs_pct_cd,stg_dim_duns.cnda_ccs_raw_scor_cd,stg_dim_duns.cnda_ccs_rsk_cls_cd,stg_dim_duns.cnda_finc_stmt_summ_pct_cd,stg_dim_duns.cnda_finc_stmt_summ_rsk_cls_cd,stg_dim_duns.cnty_cd,stg_dim_duns.co_ctry_nm,stg_dim_duns.co_nm,stg_dim_duns.co_str_yy,stg_dim_duns.co_typ_cd,stg_dim_duns.cond_ratg_cd,stg_dim_duns.cr_pnt_cd,stg_dim_duns.cr_ratg_cd,stg_dim_duns.cr_scor_cd,stg_dim_duns.cr_scor_vers_7_pct,stg_dim_duns.crcy_cd,stg_dim_duns.csad_bkrp_ind,stg_dim_duns.csad_data_hist_cd,stg_dim_duns.csad_lien_cnt,stg_dim_duns.csad_suit_cnt,stg_dim_duns.ctry_tel_acss_cd,stg_dim_duns.cty_map_cd,stg_dim_duns.cur_mgmt_str_yy,stg_dim_duns.custm_bkrp_ind,stg_dim_duns.custm_empe_here_cnt,stg_dim_duns.custm_extrc_load_and_trfm_bat_id,stg_dim_duns.custm_extrc_load_and_trfm_run_dt,stg_dim_duns.custm_fil_1_txt,stg_dim_duns.custm_hdqt_tuns_nbr,stg_dim_duns.custm_import_eprt_cd,stg_dim_duns.custm_minr_ownd_ind,stg_dim_duns.custm_otf_busn_ind,stg_dim_duns.custm_rec_del_ind,stg_dim_duns.custm_subsdy_ind,stg_dim_duns.custm_tel_nbr,stg_dim_duns.custm_tixie_ind,stg_dim_duns.data_appd_cnti_cd,stg_dim_duns.data_appd_st_nm,stg_dim_duns.data_appd_tel_nbr,stg_dim_duns.data_appd_updt_dt,stg_dim_duns.data_rep_dt,stg_dim_duns.data_updt_usr_id,stg_dim_duns.debt_ind,stg_dim_duns.dias_cd,stg_dim_duns.div_ind,stg_dim_duns.dlist_ind,stg_dim_duns.dom_ult_busn_nm,stg_dim_duns.dom_ult_ctry_cd,stg_dim_duns.dom_ult_tuns_nbr,stg_dim_duns.dom_ult_fips_ctry_cd,stg_dim_duns.dom_ult_st_abbr,stg_dim_duns.dt_ind,stg_dim_duns.due_thrty_dd_amt,stg_dim_duns.tuns_cr_ratg_cd,stg_dim_duns.dup_cur_mgmt_str_yy,stg_dim_duns.dup_jdgt_cnt,stg_dim_duns.econ_area_of_inflnc_cd,stg_dim_duns.empe_here_cd,stg_dim_duns.empe_tot_cd,stg_dim_duns.empe_tot_cnt,stg_dim_duns.empe_trnd_3_yy_cnt,stg_dim_duns.empe_trnd_5_yy_cnt,stg_dim_duns.equiv_annl_annty_stmt_dt,stg_dim_duns.equiv_annl_annty_typ_cd,stg_dim_duns.fax_nbr,stg_dim_duns.fein,stg_dim_duns.ffth_trd_styl_nm,stg_dim_duns.fil_10_txt,stg_dim_duns.fil_11_txt,stg_dim_duns.fil_12_txt,stg_dim_duns.fil_13_txt,stg_dim_duns.fil_14_txt,stg_dim_duns.fil_15_txt,stg_dim_duns.fil_16_txt,stg_dim_duns.fil_17_txt,stg_dim_duns.fil_2_txt,stg_dim_duns.fil_4_txt,stg_dim_duns.fil_5_txt,stg_dim_duns.fil_6_txt,stg_dim_duns.fil_7_txt,stg_dim_duns.fil_8_txt,stg_dim_duns.fil_9_txt,stg_dim_duns.finc_cd,stg_dim_duns.finc_strs_pct_nbr,stg_dim_duns.finc_strs_pnt_cd,stg_dim_duns.finc_strs_scor_cd,stg_dim_duns.finc_strs_scor_vers_7_1_cd,stg_dim_duns.finc_strs_scor_vers_7_1_pct_nbr,stg_dim_duns.finc_strs_scor_vers_7_cd,stg_dim_duns.finc_strs_vers_7_pct_nbr,stg_dim_duns.fips_cnty_cd,stg_dim_duns.fips_ctry_cd,stg_dim_duns.fips_metro_stat_area_cd,stg_dim_duns.fips_sdiv_1_cd,stg_dim_duns.fips_sdiv_2_cd,stg_dim_duns.fir_occr_ind,stg_dim_duns.five_yy_empe_grw_pct,stg_dim_duns.five_yy_sls_grw_pct,stg_dim_duns.frgn_fam_mbr_ind,stg_dim_duns.fst_exec_fst_nm,stg_dim_duns.fst_exec_full_nm,stg_dim_duns.fst_exec_gndr_cd,stg_dim_duns.fst_exec_lst_nm,stg_dim_duns.fst_exec_mgmt_resp_cd,stg_dim_duns.fst_exec_mid_init_abbr,stg_dim_duns.fst_exec_prfx_nm,stg_dim_duns.fst_exec_suff_nm,stg_dim_duns.fst_exec_ttl_nm,stg_dim_duns.fth_trd_styl_nm,stg_dim_duns.geo_lttd_lngd_accu_ind,stg_dim_duns.glbl_ult_ctry_cd,stg_dim_duns.glbl_ult_tuns_nbr,stg_dim_duns.glbl_ult_fips_ctry_cd,stg_dim_duns.glbl_ult_ind,stg_dim_duns.glbl_ult_nm,stg_dim_duns.glbl_ult_st_abbr,stg_dim_duns.hier_cd,stg_dim_duns.high_cr_avg_cd,stg_dim_duns.high_cr_max_cd,stg_dim_duns.inqr_cont_serv_cnt,stg_dim_duns.iso_ctry_cd,stg_dim_duns.iso_dom_ult_ctry_cd,stg_dim_duns.iso_glbl_ult_ctry_cd,stg_dim_duns.iso_hdqt_parnt_ctry_cd,stg_dim_duns.jdgt_cnt,stg_dim_duns.jdgt_ind,stg_dim_duns.lgl_nm,stg_dim_duns.lgl_sts_cd,stg_dim_duns.lgl_sts_chg_ind,stg_dim_duns.lien_cnt,stg_dim_duns.lien_ind,stg_dim_duns.lngd_txt,stg_dim_duns.lob_abbr,stg_dim_duns.lttd_txt,stg_dim_duns.mail_cnty_nm,stg_dim_duns.mail_cty_nm,stg_dim_duns.mail_st_abbr,stg_dim_duns.mail_st_addr_1_txt,stg_dim_duns.mail_st_addr_2_txt,stg_dim_duns.mail_zip_cd,stg_dim_duns.maj_ind_cat_cd,stg_dim_duns.metro_stat_area_cd,stg_dim_duns.mfr_ind,stg_dim_duns.minr_typ_cd,stg_dim_duns.mv_ind,stg_dim_duns.naics_cd,stg_dim_duns.naics_desc,stg_dim_duns.nbr_fam_mbr_cnt,stg_dim_duns.nbr_past_due_cnt,stg_dim_duns.nbr_pymt_exprs_cnt,stg_dim_duns.nbr_pymt_exprs_pydx_cnt,stg_dim_duns.net_wrth_amt,stg_dim_duns.nixie_cd,stg_dim_duns.nixie_ind,stg_dim_duns.non_cls_sic_ind,stg_dim_duns.ntl_cd,stg_dim_duns.ntl_id_nbr,stg_dim_duns.opert_fm_resd_ind,stg_dim_duns.otf_busn_yy_mm_dd,stg_dim_duns.own_ind,stg_dim_duns.own_rent_ind,stg_dim_duns.parnt_tuns_nbr,stg_dim_duns.parnt_hdqt_ctry_cd,stg_dim_duns.parnt_hdqt_fips_ctry_cd,stg_dim_duns.parnt_hdqt_nm,stg_dim_duns.parnt_hdqt_st_nm,stg_dim_duns.past_due_amt,stg_dim_duns.pblc_prvt_cd,stg_dim_duns.phys_addr_st_abbr,stg_dim_duns.phys_addr_zip_cd,stg_dim_duns.phys_cnty_nm,stg_dim_duns.phys_cty_nm,stg_dim_duns.phys_st_cd,stg_dim_duns.phys_strt_addr_1_txt,stg_dim_duns.phys_strt_addr_2_txt,stg_dim_duns.phys_zip_cd,stg_dim_duns.pop_cd,stg_dim_duns.pri_loc_acty_cd,stg_dim_duns.pri_sic_cd,stg_dim_duns.pydx_1_pydx_24_cd,stg_dim_duns.pydx_nrml_cd,stg_dim_duns.pydx_refr_cnt,stg_dim_duns.pydx_scor_cd,stg_dim_duns.pydx1_cd,stg_dim_duns.pydx10_cd,stg_dim_duns.pydx11_cd,stg_dim_duns.pydx12_cd,stg_dim_duns.pydx13_cd,stg_dim_duns.pydx14_cd,stg_dim_duns.pydx15_cd,stg_dim_duns.pydx16_cd,stg_dim_duns.pydx17_cd,stg_dim_duns.pydx18_cd,stg_dim_duns.pydx19_cd,stg_dim_duns.pydx2_cd,stg_dim_duns.pydx20_cd,stg_dim_duns.pydx21_cd,stg_dim_duns.pydx22_cd,stg_dim_duns.pydx23_cd,stg_dim_duns.pydx24_cd,stg_dim_duns.pydx3_cd,stg_dim_duns.pydx4_cd,stg_dim_duns.pydx5_cd,stg_dim_duns.pydx6_cd,stg_dim_duns.pydx7_cd,stg_dim_duns.pydx8_cd,stg_dim_duns.pydx9_cd,stg_dim_duns.pymt_expr_120_cnt,stg_dim_duns.pymt_expr_180_cnt,stg_dim_duns.pymt_expr_30_cnt,stg_dim_duns.pymt_expr_60_cnt,stg_dim_duns.pymt_expr_90_cnt,stg_dim_duns.pymt_expr_999_cnt,stg_dim_duns.pymt_expr_cnt,stg_dim_duns.pymt_expr_neg_cd,stg_dim_duns.pymt_expr_slow_cd,stg_dim_duns.pymt_expr_slow_neg_cnt,stg_dim_duns.pymt_expr_stsfctry_cnt,stg_dim_duns.rec_cls_cd,stg_dim_duns.refr_ctry_cd,stg_dim_duns.refr_ist_dt,stg_dim_duns.refr_loc_typ_cd,stg_dim_duns.refr_tran_typ_cd,stg_dim_duns.refr_updt_dt,stg_dim_duns.refr_updt_usr_id,stg_dim_duns.reg_inqr_cnt,stg_dim_duns.rent_ind,stg_dim_duns.scnd_exec_fst_nm,stg_dim_duns.scnd_exec_full_nm,stg_dim_duns.scnd_exec_gndr_cd,stg_dim_duns.scnd_exec_lst_nm,stg_dim_duns.scnd_exec_mgmt_resp_cd,stg_dim_duns.scnd_exec_mid_init_abbr,stg_dim_duns.scnd_exec_prfx_nm,stg_dim_duns.scnd_exec_suff_nm,stg_dim_duns.scnd_exec_ttl_nm,stg_dim_duns.scnd_trd_styl_nm,stg_dim_duns.sic_cd_gp_chg_ind,stg_dim_duns.site_refr_extrc_load_and_trfm_bat_id,stg_dim_duns.site_refr_extrc_load_and_trfm_run_dt,stg_dim_duns.site_refr_otf_busn_cd,stg_dim_duns.site_refr_rec_del_ind,stg_dim_duns.site_refr_tel_nbr,stg_dim_duns.site_refr_tixie_ind,stg_dim_duns.site_sts_cd,stg_dim_duns.slow_pymt_expr_cnt,stg_dim_duns.sls_amt,stg_dim_duns.sls_trnd_3_yy,stg_dim_duns.sls_trnd_5_yy,stg_dim_duns.sls_vol_chg_ind,stg_dim_duns.sls_volm_loc_amt,stg_dim_duns.sls_volm_loc_cd,stg_dim_duns.sls_volm_us_amt,stg_dim_duns.sls_volm_us_cd,stg_dim_duns.small_busn_ind,stg_dim_duns.sq_ft_amt,stg_dim_duns.st_nm,stg_dim_duns.stmt_dt,stg_dim_duns.stmt_ind,stg_dim_duns.stmt_typ_cd,stg_dim_duns.stp_ind,stg_dim_duns.str_yy,stg_dim_duns.subsdy_cd,stg_dim_duns.suit_cnt,stg_dim_duns.suit_ind,stg_dim_duns.tel_nbr_chg_ind,stg_dim_duns.thr_yy_empe_grw_pct,stg_dim_duns.thr_yy_sls_grw_pct,stg_dim_duns.thrd_exec_fst_nm,stg_dim_duns.thrd_exec_full_nm,stg_dim_duns.thrd_exec_gndr_cd,stg_dim_duns.thrd_exec_lst_nm,stg_dim_duns.thrd_exec_mgmt_resp_cd,stg_dim_duns.thrd_exec_mid_init_abbr,stg_dim_duns.thrd_exec_prfx_nm,stg_dim_duns.thrd_exec_suff_nm,stg_dim_duns.thrd_exec_ttl_nm,stg_dim_duns.thrd_trd_styl_nm,stg_dim_duns.tot_empe_cnt,stg_dim_duns.trd_styl_nm,stg_dim_duns.ufav_bkrp_ind,stg_dim_duns.unifrm_cml_cd_fl_cnt,stg_dim_duns.updt_dt,stg_dim_duns.updt_usr_id,stg_dim_duns.yy_str_chg_ind,stg_dim_duns.eff_fm_tistmp,stg_dim_duns.eff_to_tistmp);
